!function(e){function t(t){for(var i,r,a=t[0],l=t[1],c=t[2],h=0,m=[];h<a.length;h++)r=a[h],Object.prototype.hasOwnProperty.call(o,r)&&o[r]&&m.push(o[r][0]),o[r]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(e[i]=l[i]);for(d&&d(t);m.length;)m.shift()();return s.push.apply(s,c||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],i=!0,a=1;a<n.length;a++){var l=n[a];0!==o[l]&&(i=!1)}i&&(s.splice(t--,1),e=r(r.s=n[0]))}return e}var i={},o={2:0},s=[];function r(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=i,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/watermarkly/";var a=window.webpackJsonp=window.webpackJsonp||[],l=a.push.bind(a);a.push=t,a=a.slice();for(var c=0;c<a.length;c++)t(a[c]);var d=l;s.push([187,1,0]),n()}({13:function(e,t,n){"use strict";n.d(t,"c",(function(){return g})),n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return y})),n.d(t,"f",(function(){return w})),n.d(t,"d",(function(){return x})),n.d(t,"e",(function(){return O}));var i=n(0),o=n(25),s=n(4),r=n(10),a=n(1),l=n(3),c=n(11),d=n(38),h=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r};const m=n(49),p=n(50),u=n(51);let g=class extends i.Component{constructor(e){super(e),this.onBeginUpdate=this.onBeginUpdate.bind(this),this.onEndUpdate=this.onEndUpdate.bind(this),this.onBeginUpdate()}itemToSliderScale(e){const t=e*this.baseItemSize/this.baseScale;let n=Object(a.ob)(Math.pow(t-this.minItemSize,this.log),0,100);return Number.isNaN(n)&&(n=0),n}sliderToItemScale(e){const t=Math.pow(e,1/this.log)+this.minItemSize;let n=this.baseScale*t/this.baseItemSize;return Number.isNaN(n)&&(n=1),n}onScaleChange(e){const t=this.props,n=t.proxy,i=t.constraints,o=i?i.anchorX:s.a.begin,r=i?i.anchorY:s.a.begin;if(e=this.sliderToItemScale(e),n.scale!==e){const t=e*this.oldBounds.width/this.baseScale,i=e*this.oldBounds.height/this.baseScale;let l,c;switch(o){case s.a.begin:l=this.oldBounds.x;break;case s.a.middle:l=this.oldBounds.centerX-t/2;break;case s.a.end:l=this.oldBounds.x+this.oldBounds.width-t}switch(r){case s.a.begin:c=this.oldBounds.y;break;case s.a.middle:c=this.oldBounds.centerY-i/2;break;case s.a.end:c=this.oldBounds.y+this.oldBounds.height-i}n.scale=e,n.bounds=new a.g(l,c,t,i)}}onBeginUpdate(){const e=this.props,t=e.proxy;this.oldBounds=t.bounds;const n=e.imageSize;let i=1.5*n.width;this.oldBounds.height*i/this.oldBounds.width>1.5*n.height?(i=1.5*n.height,this.baseItemSize=this.oldBounds.height):this.baseItemSize=this.oldBounds.width,this.minItemSize=Math.min(5*Math.max(this.oldBounds.width,this.oldBounds.height)/Math.min(this.oldBounds.width,this.oldBounds.height),this.baseItemSize),i=Math.max(i,this.baseItemSize),this.minItemSize==i&&(this.minItemSize=0),this.log=Math.log(100)/Math.log(i-this.minItemSize),this.baseScale=t.scale}onEndUpdate(){this.props.onChanged&&this.props.onChanged()}render(){const e=this.props.proxy;return i.createElement(o.a,{value:this.itemToSliderScale(e.scale),formattedValue:e.scale.toFixed(1)+"x",onChange:this.onScaleChange,onBeginUpdate:this.onBeginUpdate,onEndUpdate:this.onEndUpdate,disableRailClicks:!0})}};h([l.c.bound],g.prototype,"onScaleChange",null),g=h([r.a],g);let b=class extends i.Component{render(){let e=this.props.proxy.opacity;return i.createElement(o.a,{value:100/.99*(e-.01),formattedValue:Math.round(100*e)+"%",onChange:this.onChange})}onChange(e){this.props.proxy.opacity=Math.round(100*Math.min(1,.01+e/(100/.99)))/100}};h([l.c.bound],b.prototype,"onChange",null),b=h([r.a],b);const f=[45,90,135,180,225,270,315];let y=class extends i.Component{render(){const e=this.props.proxy.item.rotation;return i.createElement(o.a,{value:e*(100/359.99),formattedValue:Math.round(e)+"°",onChange:this.onChange})}onChange(e){let t=Object(a.ob)(e/(100/359.99),0,360);for(let e=f.length-1;e>=0;e--)if(Math.abs(f[e]-t)<5){t=f[e];break}this.props.proxy.item.rotation=t}};function w(e,t){const n=t.bounds.minSize;return e.min/15/n}function v(e,t){const n=t.bounds.minSize;return e.min/2/n}h([l.c.bound],y.prototype,"onChange",null),y=h([r.a],y);let x=class extends i.Component{get initialValue(){return this.props.proxy.item.tileSpan}get minValue(){return Math.min(w(this.props.imageSize,this.props.proxy),this.initialValue)}get maxValue(){return Math.max(v(this.props.imageSize,this.props.proxy),this.initialValue)}render(){const e=this.minValue,t=this.maxValue,n=100*(this.initialValue-e)/(t-e);return i.createElement(o.a,{value:n,onChange:this.onChange})}onChange(e){const t=this.minValue,n=this.maxValue;this.props.proxy.item.tileSpan=t+e*(n-t)/100}};h([l.c.bound],x.prototype,"onChange",null),x=h([r.a],x);let O=class extends i.Component{constructor(e){super(e),this.onButtonClicked=Object(l.c)("set tile mode",e=>{const t=e,n=this.props.proxy,i=n.item.tile;if(n.item.tile=t,i==s.h.none&&t!==s.h.none){const e=v(this.props.imageSize,n),t=w(this.props.imageSize,n);n.item.tileSpan=(e+t)/2}})}render(){let e=this.props.proxy.item.tile;return i.createElement(d.a,{selectedIndex:e,buttons:[{children:i.createElement(c.a,{src:m})},{children:i.createElement(c.a,{src:p})},{children:i.createElement(c.a,{src:u})}],onClick:this.onButtonClicked})}};O=h([r.a],O)},187:function(e,t,n){e.exports=n(195)},188:function(e,t,n){var i=n(189);"string"==typeof i&&(i=[[e.i,i,""]]);var o={insert:"head",singleton:!1};n(16)(i,o);i.locals&&(e.exports=i.locals)},189:function(e,t,n){(e.exports=n(15)(!1)).push([e.i,".add-text-editor {\n  display: flex;\n  flex-direction: row;\n  align-content: stretch;\n  user-select: none;\n  cursor: default;\n  width: 100%;\n  height: 100%;\n  position: relative;\n}\n.add-text-editor > .editor-container {\n  position: relative;\n  flex-grow: 2;\n}\n.add-text-editor > .no-images-hint {\n  position: absolute;\n  left: 0;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  display: none;\n}\n.add-text-editor > .no-images-hint > .empty-text {\n  position: absolute;\n  left: 0;\n  right: 0;\n  top: 50%;\n  transform: translateY(-50%);\n  text-align: center;\n  user-select: none;\n}\n.add-text-editor > .no-images-hint > .empty-text > img,\n.add-text-editor > .no-images-hint > .empty-text > .svg-image {\n  user-select: none;\n  user-drag: none;\n  user-focus: none;\n  width: 96px;\n  height: 96px;\n}\n.add-text-editor > .no-images-hint > .empty-text > .hint {\n  font-size: 20px;\n  margin: 20px;\n}\n.add-text-editor > .no-images-hint > .empty-text > .or {\n  font-size: 16px;\n  margin: 20px;\n}\n.add-text-editor.no-images > .no-images-hint {\n  display: block;\n}\n",""])},190:function(e,t,n){var i=n(191);"string"==typeof i&&(i=[[e.i,i,""]]);var o={insert:"head",singleton:!1};n(16)(i,o);i.locals&&(e.exports=i.locals)},191:function(e,t,n){(e.exports=n(15)(!1)).push([e.i,'.add-text-component {\n  position: absolute;\n  left: 0;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  font-family: "Segoe UI", "San Francisco", sans-serif;\n  font-size: 14px;\n  user-select: none;\n}\n.add-text-component > .drop-cover {\n  position: absolute;\n  left: 0;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  display: none;\n  opacity: 0;\n  z-index: 2;\n  background-color: rgba(26, 109, 255, 0.33);\n  border: 3px solid #1A6DFF;\n  transition: opacity 200ms linear;\n}\n.add-text-component > .drop-cover.visible {\n  display: block;\n}\n.add-text-component > .drop-cover.hiding {\n  opacity: 0;\n}\n.add-text-component > .drop-cover.showing {\n  opacity: 1;\n}\n.add-text-component > .loading-cover {\n  position: absolute;\n  left: 0;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  display: none;\n  z-index: 1;\n  opacity: 1;\n  background: rgba(0, 0, 0, 0.01);\n}\n.add-text-component.working {\n  filter: blur(5px);\n}\n.add-text-component.working > .loading-cover {\n  display: block;\n}\n',""])},195:function(e,t,n){"use strict";n.r(t);var i=n(0),o=n(17),s=n(1),r=n(22),a=n(14),l=n(2),c=n(10),d=n(6),h=n(3),m=n(33),p=n(9),u=n(31),g=n(11),b=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r};n(188);const f=n(77);let y=class extends i.Component{constructor(e){super(e),this.onImagesChanged=this.onImagesChanged.bind(this),this.setEditorRef=this.setEditorRef.bind(this)}render(){const e=this.props,t=e.task,n=e.watermarkEditorModel,o=0===t.imageCount;return i.createElement("div",{className:Object(s.x)("add-text-editor",o&&"no-images")},i.createElement("div",{className:"editor-container"},i.createElement(u.a,{model:n,ref:this.setEditorRef,floatingOptions:!0})),i.createElement("div",{className:"no-images-hint"},i.createElement("div",{className:"empty-text"},i.createElement(g.a,{src:f}),!n.isTouch&&i.createElement(i.Fragment,null,i.createElement("div",{className:"hint"},Object(l.c)("drag-your-image-here")),i.createElement("div",{className:"or"},Object(l.c)("or")),i.createElement("button",{className:Object(s.x)("select-files"),onClick:e.onSelectPhotosClicked},Object(l.c)("select-image-action"))),n.isTouch&&i.createElement("div",{className:"hint"},Object(l.c)("select-image-for-adding-text")))))}componentDidMount(){this.taskImagesObserveDisposer=Object(h.d)(this.onImagesChanged)}componentWillUnmount(){this.taskImagesObserveDisposer&&(this.taskImagesObserveDisposer(),this.taskImagesObserveDisposer=null)}onImagesChanged(){const e=this.props.task;(e.imageCount>0?e.images[0]:null)!=this.props.watermarkEditorModel.loadedPreview&&this.watermarkEditor.reconsiderPreview()}setEditorRef(e){this.watermarkEditor=e}};y=b([c.a],y);var w=n(42),v=n(37),x=n(23),O=n(7),k=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},j=function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function r(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,a)}l((i=i.apply(e,t||[])).next())}))};n(190);let E=class extends i.Component{constructor(e){super(e),this.dropZoneState=2,this.dropZoneVisible=!1;const t=this.props.task;this.watermarkEditorModel=new u.b(t),this.addWatermarkItemDisabled=Object(h.f)(()=>0===t.imageCount),this.saveImageDisabled=Object(h.f)(()=>0===t.imageCount||0===this.watermarkEditorModel.proxies.length),this.watermarker=new w.a(t),this.setImage=this.setImage.bind(this),this.selectImageHandler=this.selectImageHandler.bind(this),this.onDragEnter=this.onDragEnter.bind(this),this.onDragOver=this.onDragOver.bind(this),this.onDrop=this.onDrop.bind(this),this.onDragLeave=this.onDragLeave.bind(this),this.showSaveImageHint=Object(s.C)(this.showSaveImageHint.bind(this),1500),this.showAddTextHint=Object(s.C)(this.showAddTextHint.bind(this),1500);let n=this.watermarkEditorModel.selectedProxyIndex;const i=Object(h.e)(()=>{n>=0&&this.watermarkEditorModel.selectedProxyIndex<0&&(this.showSaveImageHint(),i()),n=this.watermarkEditorModel.selectedProxyIndex},100)}render(){const e=this.props.task,t=this.watermarker.working;return i.createElement("div",{className:Object(s.x)("add-text-component",t&&"working",s.k),onDragEnter:this.onDragEnter},i.createElement(d.a,null),i.createElement(m.a,{pageIndex:0,hideBackButton:!0,pages:[{actions:[{name:Object(l.c)("select-image-action"),handler:this.selectImageHandler},{name:Object(l.c)("add-text-action"),disabled:this.addWatermarkItemDisabled,handler:this.watermarkEditorModel.addText},{name:Object(l.c)("add-logo-action"),disabled:this.addWatermarkItemDisabled,handler:this.watermarkEditorModel.addLogo}],children:i.createElement(y,{task:e,watermarkEditorModel:this.watermarkEditorModel,onSelectPhotosClicked:this.selectImageHandler}),nextButton:{name:Object(l.c)("save-image-action"),handler:this.saveImageHandler,disabled:this.saveImageDisabled}}]}),i.createElement("div",{className:Object(s.x)("drop-cover",this.dropZoneVisible&&"visible",2==this.dropZoneState&&"hiding",1==this.dropZoneState&&"showing"),onDragOver:this.onDragOver,onDrop:this.onDrop,onDragLeave:this.onDragLeave}),t&&i.createElement(v.a,null),i.createElement(d.c,null))}selectImageHandler(e){Object(p.g)(e.currentTarget,!0).then(this.setImage,e=>{Object(s.mb)(new Error("openFilePicker failed: "+e),!0)})}onDragEnter(e){e.preventDefault(),this.dropZoneVisible=!0,setTimeout(()=>this.dropZoneState=1,1)}onDragOver(e){e.preventDefault()}onDrop(e){e.preventDefault(),this.hideDropZone(),x.a.fromItemList(e.dataTransfer.items).then(this.setImage)}onDragLeave(e){e.preventDefault(),this.hideDropZone()}hideDropZone(){this.dropZoneState=2,setTimeout(Object(h.c)(()=>{this.dropZoneVisible=!1}),300)}setImage(e){return j(this,void 0,void 0,(function*(){if(e.length>0){const t=this.props.task;t.clearImages(),yield t.addImages(e[0]),e.length>1?this.showUpgradeToBatchMode():this.showAddTextHint()}}))}saveImageHandler(){return j(this,void 0,void 0,(function*(){this.watermarkEditorModel.selectedProxy=null,this.watermarkEditorModel.saveProxies();try{yield this.watermarker.start(!0)}catch(e){Object(p.e)(e,"Failed to add text to a picture.")}yield this.props.task.saveSettingsToLocalStorage()}))}showAddTextHint(){if(0==this.watermarkEditorModel.proxies.length){const e=s.V?document.querySelectorAll(".mobile-actions-container .page-action")[1]:document.querySelectorAll(".actions-container .page-action")[1];Object(d.i)(Object(l.c)("click-add-text-hint",Object(l.c)("add-text-action"),Object(l.c)("add-logo-action")),e,"add-text")}else this.watermarkEditorModel.highlightItems()}showSaveImageHint(){this.watermarkEditorModel.selectedProxyIndex<0&&this.watermarkEditorModel.proxies.length>0&&Object(d.i)(Object(l.c)("click-save-image-button-hint",Object(l.c)("save-image-action")),Object(m.b)(),"save-image")}showUpgradeToBatchMode(){"visualwatermark"===s.k?setTimeout(()=>{Object(d.e)({text:Object(l.c)("add-text-use-batch-tool","Visual Watermark"),buttons:[{label:Object(l.c)("download-visual-watermark-action"),onClick:O.e},{label:Object(l.c)("cancel")}],onClick:O.e})},500):setTimeout(()=>{Object(d.e)({onClick:O.u,text:Object(l.c)("add-text-use-batch-tool","Watermarkly"),buttons:[{label:Object(l.c)("run-app-action",s.k),onClick:O.u},{label:Object(l.c)("cancel")}]})},500)}};k([h.l],E.prototype,"dropZoneState",void 0),k([h.l],E.prototype,"dropZoneVisible",void 0),k([h.c.bound],E.prototype,"saveImageHandler",null),E=k([c.a],E);var C=n(46);n.d(t,"start",(function(){return P}));var S=function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function r(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,a)}l((i=i.apply(e,t||[])).next())}))};function P(e,t){return S(this,void 0,void 0,(function*(){if(!e)throw Error("root element not provided");if(!Object(s.Bb)())return void o.render(i.createElement(C.a,null),e);Object(a.c)(),Object(l.b)(t),n(65),"#test-error"===location.hash&&setTimeout(()=>{throw Error("test error")},1e3);const c=new r.b({settingsKey:"add-text-task"});c.limits={items:10,putNag:!1,images:1},yield c.loadSettingsFromLocalStorage(),s.E&&(window.task=c),o.render(i.createElement(E,{task:c}),e),Object(s.F)(),Object(p.c)(e)}))}window["start-add-text"]=P},20:function(e,t,n){"use strict";n.d(t,"f",(function(){return p})),n.d(t,"b",(function(){return g})),n.d(t,"g",(function(){return b})),n.d(t,"d",(function(){return f})),n.d(t,"c",(function(){return y})),n.d(t,"e",(function(){return w})),n.d(t,"a",(function(){return v}));var i=n(4),o=n(0),s=n(17),r=n(10),a=n(1),l=n(3),c=n(13),d=n(9),h=n(18),m=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r};function p(e,t){return 0!=e&&t.width>0&&t.height>0?"rotate("+e+" "+t.centerX+" "+t.centerY+")":""}function u(e,t,n,s,r,l,c,d,m,u){const g=p(e.rotation,t);if(e instanceof i.g){const s=function(e){return e.includes(" ")?"'"+e+"'":e}(e.fontName);if(1===e.lines.length)return o.createElement("text",Object.assign({ref:m,key:u},d,{x:t.x,y:"edge"===Object(a.q)()?t.y+i.g.defaultFontSize*n:t.y,dominantBaseline:"text-before-edge",fontSize:i.g.defaultFontSize*n,fontFamily:s,filter:r,style:c,transform:g,cursor:"default",fill:l}),e.text||"empty watermark");{const h=e.lineHeight+"em";let p="start",b=0;switch(e.alignment){case i.c.center:p="middle",b=t.width/2;break;case i.c.right:p="end",b=t.width}return o.createElement("text",Object.assign({ref:m,key:u},d,{x:t.x+b,y:"edge"===Object(a.q)()?t.y+i.g.defaultFontSize*n:t.y,dominantBaseline:"text-before-edge",fontSize:i.g.defaultFontSize*n,fontFamily:s,filter:r,style:c,transform:g,cursor:"default",fill:l}),e.lines.map((e,n)=>o.createElement("tspan",{key:"text-line-"+n,textAnchor:p,x:t.x+b,dy:0==n?"":h},e||" ")))}}if(e instanceof i.d){const i=e.img;return o.createElement("image",Object.assign({ref:m,key:u},d,{x:t.x,y:t.y,decoding:"sync",href:e.imgSrc,width:i.width*n,height:i.height*n,filter:r,style:c,transform:g}))}if(e instanceof i.f)return o.createElement("rect",Object.assign({ref:m,key:u},d,t,{fill:l,filter:r,style:c,transform:g}));if(e instanceof i.b)return o.createElement("text",Object.assign({ref:m,key:u},d,{x:t.x,y:"edge"===Object(a.q)()?t.y+i.g.defaultFontSize*n:t.y,dominantBaseline:"text-before-edge",fontSize:i.g.defaultFontSize*n,fontFamily:h.b,filter:r,style:c,transform:g,cursor:"default",fill:l}),e.char);throw Error("unsupported proxy type ("+e+")")}n(52);let g=class extends o.Component{constructor(e){if(super(e),this.setRef=this.setRef.bind(this),this.updateBounds=this.updateBounds.bind(this),this.props.rootElem){const e=a.Db?()=>this.updateBounds():Object(a.C)(this.updateBounds,1);this.updateBoundsAsync=()=>{this.dragging||this.props.selfContained||!this.props.rootElem||e()}}}get draggingImpl(){return this.props.draggingImpl}get dragging(){return this.draggingImpl&&this.draggingImpl.dragging}render(){const e=this.props,t=e.proxy,n=e.bounds||t.bounds,s=i.n[t.item.filter],r=Object(i.m)(s,e.filterId),a=Object(i.l)(s,e.filterId,t.bounds,t),l=u(t.item,n,t.scale,e.selfContained,r,e.fill,a,this.draggingImpl&&this.draggingImpl.events,this.setRef);return s.svg?o.createElement(o.Fragment,null,s.svg(n,e.filterId,t.opacity),l):l}componentDidMount(){this.updateBoundsAsync&&this.updateBoundsAsync()}componentDidUpdate(){this.updateBoundsAsync&&this.updateBoundsAsync()}setRef(e){this.elem=e}updateBounds(){const e=this.elem,t=this.props.proxy;if(e)if(e.transform&&e.transform.baseVal.numberOfItems>0){const n=[];for(let t=0;t<e.transform.baseVal.numberOfItems;t++)n.push(e.transform.baseVal.getItem(t));if(e.transform.baseVal.clear(),t.updateBounds(this.props.imageSize,e.getBoundingClientRect()),0==e.transform.baseVal.numberOfItems)for(let t=0;t<n.length;t++)e.transform.baseVal.appendItem(n[t])}else t.updateBounds(this.props.imageSize,e.getBoundingClientRect())}};function b(e,t){let n=b._cache;n||(n=new WeakMap,b._cache=n);let o=n.get(e);const s=Math.max(e.item.tileSpan,Object(c.f)(t,e));if(o&&o.mode===e.item.tile&&o.tileSpan===s&&o.bounds.equals(e.bounds)&&o.imageSize.equals(t))return o.repetitions;const r=o&&o.repetitions,l=e.item.tile==i.h.straight?function(e,t,n,i){const o=n*e.minSize*1.1,s=n*e.minSize,r=i||[];let l=0,c=e.x,d=e.y;for(;c>=-e.width;)c-=e.width+o;for(;d>=-e.height;)d-=e.height+s;const h=c;for(d+=e.height+s;d<t.height;){for(c=h+e.width+o;c<t.width;){if(l>=r.length)r.push(new a.c(c,d,e.width,e.height));else{const t=r[l];t.x=c,t.y=d,t.width=e.width,t.height=e.height}l++,c+=e.width+o}d+=e.height+s}for(;l<r.length;)r[l].reset(),l++;return r}(e.bounds,t,s,r):function(e,t,n,i){const o=n*e.minSize*1.1,s=n*e.minSize,r=i||[];let l=!1,c=0,d=e.x,h=e.y;for(;d>=-e.width;)d-=e.width+o;for(;h>=-e.height;)h-=e.height+s,l=!l;const m=d;for(h+=e.height+s,l=!l;h<t.height;){for(d=l?m+(e.width+o)/2:m+e.width+o;d<t.width;){if(c>=r.length)r.push(new a.c(d,h,e.width,e.height));else{const t=r[c];t.x=d,t.y=h,t.width=e.width,t.height=e.height}c++,d+=e.width+o}h+=e.height+s,l=!l}for(;c<r.length;)r[c].reset(),c++;return r}(e.bounds,t,s,r);return o={mode:e.item.tile,bounds:e.bounds,imageSize:t,tileSpan:s,repetitions:l},n.set(e,o),l}m([l.f],g.prototype,"dragging",null),g=m([r.a],g);let f=class extends o.Component{constructor(e){super(e),this.draggingImpl=e.draggingImpl}render(){const{proxy:e,id:t,imageSize:n}=this.props,s=b(e,n),r=Object.assign({},this.props),a=i.n[e.item.filter],l=Object(i.m)(a,r.filterId),c=Object(i.l)(a,r.filterId,e.bounds,e),d=this.nodeList||(this.nodeList=[]);d.length>0&&d.splice(0);let h=!1;for(let n=0,i=s.length;n<i;n++){const i=s[n];if(i.empty)break;if(i.x==e.bounds.x&&i.y==e.bounds.y){if(h)continue;h=!0;const e=t+"-rep-root";r.rootElem=!0,r.bounds=null,d.push(o.createElement(g,Object.assign({key:e},r)))}else{const o=t+"-rep-"+n;a.svg&&d.push(a.svg(i,r.filterId,e.item.opacity,o+"-filter-bg")),d.push(u(e.item,i,e.scale,r.selfContained,l,this.props.fill,c,this.draggingImpl&&this.draggingImpl.events,null,o))}}return o.createElement(o.Fragment,null,d)}};f=m([r.a],f);let y=class extends o.Component{constructor(e){super(e)}render(){const e=this.props.owner,t=e.snappedZones;return t&&0!=t.length&&e.isDragging?o.createElement(o.Fragment,null,t.map((e,t)=>e instanceof d.b?o.createElement("line",{key:"snapped-zone-"+t,className:"snap-line",x1:Math.max(1,e.x1),y1:Math.max(1,e.y1),x2:Math.max(1,e.x2),y2:Math.max(1,e.y2)}):null)):null}};function w(e){const t=document.createElementNS("http://www.w3.org/2000/svg","svg");return t.setAttribute("width","500"),t.setAttribute("height","500"),Object.assign(t.style,{position:"absolute",left:0,top:0,width:window.innerWidth,height:window.innerHeight,opacity:0}),document.body.appendChild(t),new Promise((n,r)=>{const c=new i.i({item:e});let d=!1;const h=Object(l.d)(()=>{const e=c.bounds;e.width>0&&e.height>0&&(d=!0,h(),t.remove(),n(e.size))});s.render(o.createElement(g,{proxy:c,proxies:[c],imageSize:new a.i(window.innerWidth,window.innerHeight),filterId:"",fill:"#ffffff",id:"item1",bounds:new a.g(0,0,50,25),rootElem:!0,selfContained:!1}),t,()=>{setTimeout(()=>{d||(h(),t.remove(),r(new Error("Cannot calculate size in time")))},2e3)})})}function v(e){return"radial"===e.gradient.type?o.createElement("radialGradient",{id:e.id},o.createElement("stop",{offset:"0%",stopColor:e.gradient.start.hexString}),o.createElement("stop",{offset:"100%",stopColor:e.gradient.end.hexString})):o.createElement("linearGradient",{id:e.id,gradientTransform:"rotate("+(90+e.gradient.angle)+")"},o.createElement("stop",{offset:"0%",stopColor:e.gradient.start.hexString}),o.createElement("stop",{offset:"100%",stopColor:e.gradient.end.hexString}))}y=m([r.a],y)},24:function(e,t,n){"use strict";n.d(t,"d",(function(){return y})),n.d(t,"f",(function(){return w})),n.d(t,"c",(function(){return v})),n.d(t,"a",(function(){return x})),n.d(t,"e",(function(){return k})),n.d(t,"b",(function(){return E}));var i=n(0),o=n(1),s=n(6),r=n(10),a=n(5),l=n(2),c=n(11),d=n(7),h=n(21),m=n(9),p=function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function r(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,a)}l((i=i.apply(e,t||[])).next())}))};n(54);const u=n(35),g=new h.a("account-creation-email",""),b=new h.a("account-creation-name","");function f(e,t){setTimeout(()=>{t?Object(s.e)({text:e,buttons:[{label:Object(l.c)("upgrade-to-higher-version",Object(a.m)(a.t.get())),onClick:()=>L(t)},{label:Object(l.c)("cancel")}]}):Object(s.h)({position:"center",children:e})},500)}function y(e){e.imageCount==o.N?setTimeout(()=>{Object(s.e)({text:Object(l.c)("images-hard-limit-exceeded",o.N,o.l),buttons:[{label:Object(l.c)("download-desktop-app"),onClick:d.e},{label:Object(l.c)("cancel")}],onClick:d.e})},500):e.imageCount==e.limits.images&&setTimeout(()=>{Object(s.e)({text:Object(l.c)("free-edition-limit-exceeded",e.limits.images,o.l),buttons:[{label:Object(l.c)("buy-app"),onClick:E},{label:Object(l.c)("cancel")}]})},500)}function w(e){a.h.get()?f(Object(l.c)("item-limit-exceeded",Object(a.m)(a.l.get()),e.limits.items),a.t.get()):f(Object(l.c)("item-hard-limit-exceeded",e.limits.items,o.l))}function v(e){f(Object(l.c)("font-available-in-higher-edition",Object(a.m)(e)),e)}o.E&&(window.showNag=f);const x=Object(r.a)(e=>{const t=a.c.get(),n=e.isIOsApp;return!n||Object(d.p)()||d.D?o.V?i.createElement("div",{className:"account-component"},t&&a.h.get()&&i.createElement("button",{className:"upgrade-button",onClick:L},Object(l.c)("upgrade-to-higher-version",Object(a.m)(a.t.get()))),!t&&i.createElement(i.Fragment,null,i.createElement("button",{className:"buy-button",onClick:E},Object(l.c)("buy-app")),i.createElement("button",{className:"activate-button",onClick:k},n?Object(l.c)("sign-in-action"):Object(l.c)("activate-license")))):i.createElement("div",{className:"account-component"},i.createElement("span",{className:"edition-name"},Object(l.c)("version-placeholder",a.n.get())),t&&a.h.get()&&i.createElement("button",{className:"upgrade-button",onClick:L},Object(l.c)("upgrade-to-higher-version",Object(a.m)(a.t.get()))),!t&&i.createElement(i.Fragment,null,i.createElement("button",{className:"buy-button",onClick:E},Object(l.c)("buy-app")),i.createElement("button",{className:"activate-button",onClick:k},Object(l.c)("activate-license")))):i.createElement("div",{className:"account-component"},t&&i.createElement("span",null," "),!t&&i.createElement("button",{className:"activate-button",onClick:k},Object(l.c)("sign-in-action")))});function O(){return p(this,void 0,void 0,(function*(){if(o.T){if(yield function(){return p(this,void 0,void 0,(function*(){if(Object(d.p)())try{const e=yield Object(s.j)(d.y),t=yield Object(s.j)(Object(m.i)(()=>Object(a.k)(b.get(),g.get(),e)));if(t)return yield j(t)}catch(e){return Object(o.mb)(e,!0),!1}return!1}))}())return}let e,t;const n=()=>e.close();e=Object(s.g)({position:"center",children:i.createElement("div",{className:"activate-dialog-component popover-dialog"},i.createElement("div",{className:"dialog-header"},i.createElement("h2",null,Object(l.c)("restore-purchase-action")),i.createElement(c.a,{src:u,className:"close-button",onClick:n})),i.createElement("p",null,Object(l.c)("restore-purchase-text")),i.createElement("input",{type:"email",className:"w-100 mb-2",ref:e=>{t=e},autoFocus:!0,defaultValue:g.get(),placeholder:Object(l.c)("email-title")}),i.createElement("button",{onClick:()=>p(this,void 0,void 0,(function*(){if(g.set(t.value),!g.get())return t.classList.add("shake-animation"),void setTimeout(()=>{t.classList.remove("shake-animation"),t.focus()},1e3);try{(yield Object(s.j)(Object(m.i)(()=>Object(a.B)(g.get()))))?(Object(s.h)({position:"center",children:"Please check your mailbox including the spam folder."}),e.close()):Object(s.h)({position:"center",className:"error",children:"It seems you used a different email address to purchase the app."})}catch(e){Object(s.h)({position:"center",className:"error",children:"An unexpected error happened. Check your computer is connected to internet and try again, please."})}}))},Object(l.c)("submit-button")),i.createElement("button",{onClick:n},Object(l.c)("cancel")))})}))}function k(){let e,t,n;const r=()=>e.close();e=Object(s.g)({position:"center",children:i.createElement("div",{className:"activate-dialog-component popover-dialog"},i.createElement("div",{className:"dialog-header"},i.createElement("h2",null,o.T?Object(l.c)("sign-in-action"):Object(l.c)("activate-dialog-title",o.l)),i.createElement(c.a,{src:u,className:"close-button",onClick:r})),i.createElement("input",{type:"email",className:"w-100 mb-2",ref:e=>{t=e},autoFocus:!0,defaultValue:g.get(),placeholder:Object(l.c)("email-title")}),i.createElement("input",{type:"text",className:"w-100 mb-2",ref:e=>{n=e},placeholder:o.T?Object(l.c)("password-title"):Object(l.c)("activation-key-title")+" "+Object(l.c)("or")+" "+Object(l.c)("password-title")}),i.createElement("button",{onClick:()=>p(this,void 0,void 0,(function*(){g.set(t.value);let i=n.value;if(!g.get())return t.classList.add("shake-animation"),void setTimeout(()=>{t.classList.remove("shake-animation"),t.focus()},1e3);if(!i)return n.classList.add("shake-animation"),void setTimeout(()=>{n.classList.remove("shake-animation"),n.focus()},1e3);(yield j({email:g.get(),key:i}))&&e.close()}))},Object(l.c)("submit-button")),i.createElement("button",{onClick:r},Object(l.c)("cancel")),i.createElement("button",{onClick:()=>{r(),O()}},Object(l.c)("restore-purchase-action")))})}function j(e,t,n,r,c){return p(this,void 0,void 0,(function*(){n=n||a.b;try{return yield Object(s.j)(n(e)),Object(s.h)({position:"center",children:Object(l.c)("successful-activation",o.l)}),!0}catch(d){if(d instanceof a.a){if(d.reason==a.r&&!t)return yield Object(s.j)(Object(o.B)(c||2e3)),j(e,!0,n,r,c);if(yield function(e,t,n,r){return n=n||a.i,new Promise(c=>{switch(e.reason){case a.o:Object(s.e)({text:Object(l.c)("computer-limit-exceeded"),buttons:[{label:Object(l.c)("cancel-older-activations"),onClick:()=>p(this,void 0,void 0,(function*(){try{yield Object(s.j)(n(t)),c(!0)}catch(e){try{yield Object(s.j)(Object(o.B)(r||2e3)),yield Object(s.j)(n(t)),c(!0)}catch(e){Object(o.mb)(e),c(!1)}}}))},{label:Object(l.c)("do-not-activate"),onClick:()=>{c(!1)}}]});break;case a.p:let e=Object(s.g)({className:"error",position:"center",children:i.createElement(i.Fragment,null,i.createElement("p",{dangerouslySetInnerHTML:{__html:Object(l.c)("purchase-was-cancelled",o.Ab)}}),i.createElement("button",{onClick:m.f},Object(l.c)("contact-us-action")),i.createElement("button",{onClick:()=>e.close()},Object(l.c)("close-action")))});c(!1);break;case a.q:let d=Object(s.g)({className:"error",position:"center",children:i.createElement(i.Fragment,null,i.createElement("p",{dangerouslySetInnerHTML:{__html:Object(l.c)("typo-in-activation-key",o.Ab)}}),i.createElement("button",{onClick:m.f},Object(l.c)("contact-us-action")),i.createElement("button",{onClick:()=>d.close()},Object(l.c)("close-action")))});c(!1);break;default:let h=Object(s.h)({className:"error",position:"center",children:i.createElement(i.Fragment,null,i.createElement("p",{dangerouslySetInnerHTML:{__html:Object(l.c)("unexpected-error-during-activation",o.Ab)}}),i.createElement("button",{onClick:m.f},Object(l.c)("contact-us-action")),i.createElement("button",{onClick:()=>h.close()},Object(l.c)("close-action")))});c(!1)}})}(d,e,r,c))return j(e,!0,n,r,c)}else Object(o.mb)(d)}return!1}))}function E(){if(o.T&&Object(d.p)())!function(){p(this,void 0,void 0,(function*(){if(a.c.get())return void Object(o.mb)("showInAppBuyOptions shouldn't be called when the app is already activated.",!0);let e;const t=new h.a("in-app-receipt","");if(t.get()&&b.get()&&g.get())return void(yield I(b.get(),g.get(),t.get()));function n(n){return p(this,void 0,void 0,(function*(){e.close();const i=yield Object(d.f)();let r=()=>p(this,void 0,void 0,(function*(){const e=yield P(i[n],b.get(),g.get());if(e){b.set(e.name),g.set(e.email);try{if(t.set(yield Object(s.j)(()=>Object(d.v)(n))),!t.get())return void Object(s.h)({className:"error",children:"We weren't able to process the payment. Try again, please."});yield I(b.get(),g.get(),t.get())}catch(e){Object(o.mb)(e,!0);const t=e.message||e.toString();Object(s.h)({className:"error",children:"We weren't able to process the payment: "+t+". Try again, please. You won't be charged twice."})}}}));o.Db?yield r():setTimeout(r,500)}))}const r=yield Object(s.j)(d.f);e=Object(s.g)({position:"center",anchorElem:document.body,children:i.createElement("div",{className:"pricing-options popover-dialog"},i.createElement("div",{className:"dialog-header"},i.createElement("h2",null,Object(l.c)("in-app-purchase-title")),i.createElement(c.a,{src:u,className:"close-button",onClick:()=>{e.close()}})),i.createElement("p",null,Object(l.c)("in-app-description")),i.createElement(S,{name:"Basic",price:r[d.j],devices:1,fonts:100,personalUse:!0,watermarksPerImage:1,buyClickHandler:function(){return n(d.j)}}),i.createElement(S,{name:"Plus",price:r[d.m],devices:2,fonts:400,personalUse:!1,watermarksPerImage:3,buyClickHandler:function(){return n(d.m)}}),i.createElement(S,{name:"Premium",price:r[d.o],devices:10,fonts:1e3,personalUse:!1,watermarksPerImage:100,buyClickHandler:function(){return n(d.o)}}))})}))}();else{let e;switch(o.k){case"makewatermark":e="https://makewatermark.com/pricing/";break;case"visualwatermark":e="en"===Object(l.a)()?"https://www.visualwatermark.com/buy/":"https://www.visualwatermark.com/"+Object(l.a)()+"/buy/";break;default:e="en"===Object(l.a)()?"https://watermarkly.com/pricing/":"https://watermarkly.com/"+Object(l.a)()+"/pricing/"}const t=Object(d.t)(e);t&&(t["load-watermarkly-activation"]=a.v)}}var C;function S(e){const{name:t,price:n,personalUse:o,devices:s,fonts:r,watermarksPerImage:a,buyClickHandler:c}=e;return i.createElement("div",{className:"pricing-option"},i.createElement("h2",null,t),i.createElement("p",null,i.createElement("strong",null,o?Object(l.c)("in-app-personal-use-only"):Object(l.c)("in-app-commercial-use"))),i.createElement("p",null,Object(l.c)("in-app-platforms-list")),i.createElement("p",null,Object(l.c)("in-app-no-ads")),i.createElement("p",null,1==s?Object(l.c)("in-app-1-device"):Object(l.c)("in-app-x-devices",s)),i.createElement("p",null,Object(l.c)("in-app-x-fonts",r)),i.createElement("p",null,1==a?Object(l.c)("in-app-1-watermark"):Object(l.c)("in-app-x-watermarks",a)),i.createElement("p",null,Object(l.c)("in-app-photos-videos")," ",i.createElement("small",null,Object(l.c)("in-app-photos-videos-comment"))),i.createElement("button",{onClick:c},Object(l.c)("in-app-buy",n)))}function P(e,t,n){return o.Db&&P.testValues?Promise.resolve(P.testValues):new Promise(r=>{let a,d=!1;const h=e=>{d||(d=!0,r(e))};let m,p;a=Object(s.g)({position:"center",onClosed:()=>h(null),children:i.createElement("div",{className:"create-account-dialog popover-dialog"},i.createElement("div",{className:"dialog-header"},i.createElement("h2",null,Object(l.c)("create-account-title")),i.createElement(c.a,{src:u,className:"close-button",onClick:()=>{a.close()}})),i.createElement("p",null,Object(l.c)("create-account-description")),i.createElement("input",{ref:e=>{p=e},type:"text",placeholder:"name",autoFocus:!0,defaultValue:t,className:"w-100 mb-2"}),i.createElement("input",{ref:e=>{m=e},type:"email",placeholder:"email",defaultValue:n,className:"w-100 mb-2"}),i.createElement("button",{onClick:()=>(n=m.value,(t=p.value)?Object(o.ab)(n)?(h({name:t,email:n}),void a.close()):(m.classList.add("shake-animation"),void setTimeout(()=>{m.classList.remove("shake-animation"),m.focus()},1e3)):(p.classList.add("shake-animation"),void setTimeout(()=>{p.classList.remove("shake-animation"),p.focus()},1e3)))},Object(l.c)("create-and-buy-action",e)))})})}function I(e,t,n){return p(this,void 0,void 0,(function*(){try{const i=yield Object(s.j)(()=>p(this,void 0,void 0,(function*(){let i=yield Object(a.k)(e,t,n);return i||(yield Object(o.B)(1e3),i=yield Object(a.k)(e,t,n)),i})));i?yield j(i):Object(s.h)({className:"error",children:"We weren't able to create an account. Try again, please. You won't be charged twice."})}catch(e){Object(o.mb)(e,!0);const t=e.message||e.toString();Object(s.h)({className:"error",children:"We weren't able to process the payment: "+t+". Try again, please. You won't be charged twice."})}}))}function L(e){return p(this,void 0,void 0,(function*(){if(a.h.get()){("number"!=typeof e||e!=a.x&&e!=a.z)&&(e=a.t.get());const t=a.d.get(),n=a.f.get();if(!t||!n)return Object(o.mb)(new Error("upgrade method is called for non-activated app"),!0),void Object(s.e)({text:"It seems the app isn't activated. Please to activate it first.",buttons:[{label:"Contact Support",onClick:m.f},{label:Object(l.c)("cancel")}]});if(o.T&&Object(d.p)()){let i="";if(e==a.x?i=d.k:e==a.z&&a.l.get()==a.g?i=d.l:e==a.z&&a.l.get()==a.x&&(i=d.n),i){let e;try{e=yield Object(s.j)(()=>Object(d.v)(i))}catch(e){return Object(o.mb)(e,!0),void Object(s.e)({text:"Unfortunately, we couldn't process the payment. Please check if you have sufficient balance on the credit card. If it still doesn't work, contact us, please.",buttons:[{label:"Contact Support",onClick:m.f},{label:Object(l.c)("cancel")}]})}const r=()=>p(this,void 0,void 0,(function*(){yield Object(s.j)(()=>Object(a.C)(t,n,e)),yield Object(s.j)(a.j),Object(s.h)({position:"center",children:Object(l.c)("successful-activation",o.l)})})),c=()=>p(this,void 0,void 0,(function*(){try{yield r()}catch(e){yield Object(s.j)(()=>Object(o.B)(2e3));try{yield r()}catch(e){Object(o.mb)(e,!0),Object(s.e)({text:"Unfortunately, upgrade didn't go through. Check if you have internet connect and try again, please. You will NOT be charged again - the phone will offer to get the upgrade for free.",buttons:[{label:"Try again",onClick:c},{label:"Contact Support",onClick:m.f},{label:Object(l.c)("cancel")}]})}}}));yield c()}}else Object(d.t)(a.D+"?email="+t+"&pwd="+n+"&edition="+e)}}))}!function(e){e[e.standard=0]="standard",e[e.faster=1]="faster",e[e.fastest=2]="fastest"}(C||(C={}))},30:function(e,t,n){"use strict";n.d(t,"a",(function(){return x})),n.d(t,"f",(function(){return k})),n.d(t,"c",(function(){return j})),n.d(t,"b",(function(){return C})),n.d(t,"d",(function(){return S})),n.d(t,"e",(function(){return P}));var i=n(1),o=n(14),s=n(22),r=n(4),a=n(42),l=n(18),c=n(19),d=n(3),h=n(26),m=n(6),p=n(2),u=n(8),g=n(7),b=n(12),f=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},y=function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function r(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,a)}l((i=i.apply(e,t||[])).next())}))};const w=n(84);function v(){if(localStorage.getItem("notification-about-syncing"))return;localStorage.setItem("notification-about-syncing","true");let e="";["fr","it","ko","ru"].indexOf(Object(p.a)())>=0&&(e=Object(p.a)()+"/");let t="https://watermarkly.com/"+e+"blog/template-sync/";const n=Object(m.f)({position:"center",title:Object(p.c)("new-feature"),children:Object(p.c)("sync-feature-notification-text"),buttons:[{onClick:()=>n.close(),text:"OK"},{onClick:()=>Object(g.t)(t),text:Object(p.c)("learn-more-action")}]})}i.E&&(window.showNotificationAboutSyncing=v);class x{constructor(e="template-loader-",t=10){this.settingsPrefix=e,this.records=[],this.maxCount=t,this.changeCounter=0,this.saveValueKeys=this.saveValueKeys.bind(this),this.onChanged=this.onChanged.bind(this),this.initPromise=this.init()}init(){return y(this,void 0,void 0,(function*(){const e=yield Object(b.e)(this.indexKey());if(e&&Array.isArray(e))for(let t=0;t<e.length;t++)this.records.push({key:e[t],preview:null,settings:null,serverId:null,createdOn:null,synced:Object(d.l)(!1)});let t=!1;for(let e=this.records.length-1;e>=0;e--){const n=this.records[e],o=n.key,s=yield Object(b.e)(this.previewKey(o));if(!(s instanceof Blob)){t=!0,yield this.removeCore(e,!1);continue}n.preview=s;if(!(yield this.getTemplateSettings(n))){t=!0,yield this.removeCore(e,!1);continue}const r=yield Object(b.e)(this.metaKey(o));r?(r.createdOn instanceof Date||(Object(i.mb)(new Error("recordMeta.createdOn isn't a Date object: "+Object.keys(r.createdOn))),r.createdOn=Object(i.Fb)()),n.serverId=r.serverId,n.createdOn=r.createdOn):(n.serverId=null,n.createdOn=Object(i.Fb)()),n.synced.set(!!n.serverId)}t&&(yield this.saveValueKeys());localStorage.getItem(this.removeDuplicateKeys())||(localStorage.setItem(this.removeDuplicateKeys(),"local"),yield this.removeDuplicates()),this.onChanged()}))}count(){return y(this,void 0,void 0,(function*(){return yield this.initPromise,this.records.length}))}clear(){return y(this,void 0,void 0,(function*(){let e=yield this.count();if(0!=e){for(;e>0;)yield this.removeCore(0,!1),e--;yield this.saveValueKeys(),this.onChanged()}}))}get(e){return y(this,void 0,void 0,(function*(){return yield this.initPromise,this.getCore(e)}))}getCore(e){return y(this,void 0,void 0,(function*(){if(e<0||e>=this.records.length)throw new o.a("index",e);const t=this.records[e],n=yield this.getTemplateSettings(t);return n&&void 0!==n.images&&(delete n.images,delete n.imagesTime),n}))}getTemplateSettings(e){return y(this,void 0,void 0,(function*(){return e.settings||(e.settings=yield Object(b.e)(this.settingsKey(e.key))),e.settings}))}previews(){return y(this,void 0,void 0,(function*(){return yield this.initPromise,this.records.map(e=>({blob:e.preview,synced:e.synced}))}))}indexOf(e){return y(this,void 0,void 0,(function*(){return yield this.initPromise,yield this.indexOfCore(e)}))}indexOfCore(e){return y(this,void 0,void 0,(function*(){for(let t=0;t<this.records.length;t++){const n=this.records[t].settings||(yield this.getCore(t));if(Object(s.d)(n,e))return t}return-1}))}remove(e){return y(this,void 0,void 0,(function*(){yield this.initPromise,this.syncPromise&&(yield this.syncPromise),yield this.removeCore(e,!0),yield this.saveValueKeys(),this.onChanged()}))}removeCore(e,t){return y(this,void 0,void 0,(function*(){if(e<0||e>=this.records.length)throw new o.a("index",e);const n=this.records[e],i=n.key;this.records.splice(e,1),yield Object(b.c)(this.settingsKey(i)),yield Object(b.c)(this.previewKey(i)),yield Object(b.c)(this.metaKey(i)),t&&n.serverId&&this.backend&&(yield this.backend.deleteTemplate(n.serverId))}))}put(e,t,n=Object(i.Fb)(),o=null){return y(this,void 0,void 0,(function*(){yield this.initPromise;const i=yield this.indexOfCore(t);i>=0&&(yield this.removeCore(i,!1)),yield this.forcePut(e,t,n,o)}))}forcePut(e,t,n=Object(i.Fb)(),o=null){return y(this,void 0,void 0,(function*(){delete t.images,delete t.imagesTime;const s={key:""+Object(i.rb)(),settings:t,preview:e,serverId:o,createdOn:n,synced:Object(d.l)(!!o)};this.records.splice(0,0,s);const r=s.key;yield Object(b.h)(this.settingsKey(r),s.settings),yield Object(b.h)(this.previewKey(r),s.preview);try{this.backend&&!o&&this.maxServerTemplateCount>0&&(yield this.syncPromise,s.serverId=yield this.backend.putTemplate({template:t,createdOn:n,format:1}),s.synced.set(!!s.serverId))}catch(e){Object(i.mb)(e,!0)}yield this.saveRecordMeta(s),this.records.length>this.maxCount&&(yield this.removeCore(this.records.length-1,!1)),yield this.saveValueKeys(),this.onChanged()}))}saveRecordMeta(e){return y(this,void 0,void 0,(function*(){return Object(b.h)(this.metaKey(e.key),{serverId:e.serverId,createdOn:e.createdOn})}))}saveValueKeys(){return this.records.length>0?Object(b.h)(this.indexKey(),this.records.map(e=>e.key)):Object(b.c)(this.indexKey())}onChanged(){this.changeCounter++,this.observableCount=this.records.length}getSyncStates(){return y(this,void 0,void 0,(function*(){return yield this.initPromise,this.records.map(e=>{const t=e.synced.get();if(i.E&&t!==!!e.serverId)throw new Error("Sync state is different from serverId");return t})}))}removeDuplicates(){return y(this,void 0,void 0,(function*(){try{for(let e=this.records.length-1;e>=0;e--){const t=yield this.indexOfCore(this.records[e].settings);t>=0&&t<e&&(yield this.removeCore(t,!0))}}finally{yield this.saveValueKeys(),this.onChanged()}}))}startSync(e){return y(this,void 0,void 0,(function*(){this.backend=e,this.syncPromise=this.doSync(),yield this.syncPromise;const t=localStorage.getItem(this.removeDuplicateKeys());t&&"local"!=t||(localStorage.setItem(this.removeDuplicateKeys(),"server"),yield this.removeDuplicates())}))}doSync(){return y(this,void 0,void 0,(function*(){if(!this.backend)return;const e=e=>y(this,void 0,void 0,(function*(){try{return yield this.backend.getTemplate(e)}catch(e){return null}})),t=e=>this.records.find(t=>t.serverId===e);yield this.initPromise;const n=yield this.backend.templateIds();n.maxTemplateCount>0&&0===n.templates.length&&this.records.length>0&&Object(m.d)()&&v();const i=[];i.push.apply(i,this.records);for(let e=n.templates.length-1;e>=0;e--){const o=n.templates[e];if(1!=o.format)continue;t(o.id)||i.push(o)}i.sort((e,t)=>t.createdOn-e.createdOn),this.maxServerTemplateCount=n.maxTemplateCount;for(let t=Math.min(i.length-1,n.maxTemplateCount-1);t>=0;t--){const o=i[t];if(o.key&&this.maxServerTemplateCount>0){if(o.serverId){if(n.templates.find(e=>e.id==o.serverId))continue}const e=o,t=yield this.getTemplateSettings(e);e.serverId=yield this.backend.putTemplate({format:1,createdOn:e.createdOn,template:t}),e.synced.set(!!e.serverId),yield this.saveRecordMeta(e)}else if(!o.key&&o.id){const t=o.id,n=yield e(t);if(n){const e=yield this.indexOfCore(n);if(e>=0){const n=this.records[e];n.serverId?n.serverId!=t&&(yield this.backend.deleteTemplate(t)):(n.serverId=t,n.synced.set(!!n.serverId),yield this.saveRecordMeta(n))}else{const e=new s.b;yield e.loadSettings(n);const i=yield k(e,j);yield this.put(i,n,o.createdOn,t)}}}}}))}indexKey(){return this.settingsPrefix+"key"}settingsKey(e){return this.settingsPrefix+"settings-"+e}previewKey(e){return this.settingsPrefix+"preview-"+e}metaKey(e){return this.settingsPrefix+"preview-"+e+"-meta"}removeDuplicateKeys(){return this.settingsPrefix+"remove-duplicates"}}let O;function k(e,t){return y(this,void 0,void 0,(function*(){if(O)return O(e,t);const n=yield function(e,t){return y(this,void 0,void 0,(function*(){const n=e.items.some(e=>e instanceof r.g),o=e.items.some(e=>e instanceof r.b),s=n||o?yield Object(l.d)(o):"",c=Object(i.y)(t.width,t.height),d=e.toProxies(t,!0,0);!function(e,t){const n=t.width/3,i=t.height/3;for(let o=e.length-1;o>=0;o--){const s=e[o];if(s.bounds.width<n&&s.bounds.height<i){const e=s.bounds.width>s.bounds.height?n/s.bounds.width:i/s.bounds.height,o={width:e*s.bounds.width,height:e*s.bounds.height};s.updateBounds(t,o),s.scale*=e}}}(d,t);const h=yield Object(a.b)(new i.i(c),d,s),m=c.getContext("2d");return m.fillStyle=function(e){let t=0;for(let n=e.length-1;n>=0;n--){const o=e[n];if(o.item instanceof r.g||o.item instanceof r.b||o.item instanceof r.f)t+=o.item.color.brightness;else if(o.item instanceof r.d){const e=o.item.img,n=e.getContext("2d");let i=e.width/5,s=e.height/5,r=0,a=0;for(let t=0;t<e.height;t+=s)for(let o=0;o<e.width;o+=i){const e=n.getImageData(o,t,1,1).data;e[3]>0&&(r+=Object(u.c)(e),a++)}a>=1&&(t+=2*r/a)}else Object(i.mb)(new Error("Unknown watermark item type: "+Object(i.w)(o.item)),!0)}return t/e.length<150}(d)?"#ffffff":"#000000",m.fillRect(0,0,t.width,t.height),m.drawImage(h,0,0),c}))}(e,t),o=yield Object(c.b)(n,"image/jpeg",.8);return n.width=0,n.height=0,o}))}f([d.l],x.prototype,"changeCounter",void 0),f([d.l],x.prototype,"observableCount",void 0),f([d.c],x.prototype,"onChanged",null);const j=new i.i(300,200),E="https://backend.watermarkly.com";class C{constructor(e,t){this.email=e,this.key=t}templateIds(){return new Promise((e,t)=>{h.get(E+"/api/templates/v1").query({email:this.email,pwd:this.key}).responseType("json").end((n,i)=>{if(n)t(n);else{const n=i.body;if(n.templates){for(let e=0,t=n.templates.length;e<t;e++){const t=n.templates[e];"string"==typeof t.createdOn&&(t.createdOn=new Date(t.createdOn))}e(n)}else t(new Error("Server returned unknown object: "+Object.keys(n)))}})})}deleteTemplate(e){return new Promise((t,n)=>{h.delete(E+"/api/template/v1").query({id:e}).end(e=>{e?n(e):t()})})}getTemplate(e){return new Promise((t,n)=>{h.get(E+"/api/template/v1").query({id:e}).responseType("arraybuffer").end((e,i)=>{if(e)n(e);else{const e=i.body;if(e){const n=w.decode(new Uint8Array(e));t(Object(b.k)(n))}else t(null)}})})}putTemplate(e){return y(this,void 0,void 0,(function*(){const t=w.encode(yield Object(b.j)(e.template));return new Promise((n,i)=>{const o=new Blob([t],{type:"application/octet-stream"});h.post(E+"/api/template/v1").query({email:this.email,pwd:this.key,createdOn:e.createdOn.toISOString(),format:1}).send(o).responseType("text").end((e,t)=>{e?i(e):n(t.text)})})}))}}function S(e,t){return y(this,void 0,void 0,(function*(){const n={type:"watermarkly-template",version:1,template:yield e.get(t)};return new Blob([String.fromCharCode(65279),JSON.stringify(n)],{type:"application/watermarkly"})}))}function P(e,t){return y(this,void 0,void 0,(function*(){try{const n=yield Object(i.jb)(t),o=n?JSON.parse(n):{};if(o&&"watermarkly-template"===o.type){if(1===o.version){const t=new s.b;yield t.loadSettings(o.template);const n=i.Db?Object(i.o)():yield k(t,j);yield e.put(n,o.template)}}}catch(e){Object(i.mb)(e,!0)}}))}},31:function(e,t,n){"use strict";var i=n(22),o=n(4),s=n(0),r=n(10),a=n(1),l=n(3),c=n(34),d=n(13),h=n(67),m=n(9),p=n(24),u=n(18),g=n(48),b=n(5),f=n(2),y=n(37),w=n(25),v=n(38),x=n(11),O=n(30),k=n(36),j=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},E=function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function r(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,a)}l((i=i.apply(e,t||[])).next())}))};n(69);const C=n(35),S=n(87),P=n(71);let I=class extends s.Component{constructor(e){super(e),this.previews=[],this.onDeleteTemplateClicked=this.onDeleteTemplateClicked.bind(this),this.onDownloadTemplateClicked=this.onDownloadTemplateClicked.bind(this),this.updatePreviews=this.updatePreviews.bind(this),this.updatePreviews()}get visible(){return this.props.visible&&this.props.templateLoader&&this.props.templateLoader.observableCount>0}render(){return s.createElement("div",{className:Object(a.x)("inline-templates-component",this.visible&&"visible",this.props.vertical&&"vertical")},s.createElement("h3",null,Object(f.c)("watermark-templates")),s.createElement("div",{className:"templates-container"},this.previews.map((e,t)=>s.createElement("div",{className:"img",key:"preview-"+t},s.createElement("img",{src:e.img,onClick:e.clickHandler}),s.createElement(x.a,{src:S,className:"download-button","data-index":t,title:Object(f.c)("download-template-action"),onClick:this.onDownloadTemplateClicked}),s.createElement(x.a,{src:C,className:"delete-button","data-index":t,title:Object(f.c)("delete-template-action"),onClick:this.onDeleteTemplateClicked}),e.synced.get()&&s.createElement(x.a,{src:P,className:"sync-state",title:Object(f.c)("template-was-synced")})))))}componentDidMount(){this.subscribeToChanges()}componentWillUnmount(){this.unsubscribeFromChanges()}subscribeToChanges(){this.unobserve=this.props.templateLoader&&Object(l.m)(this.props.templateLoader,"changeCounter",this.updatePreviews)}unsubscribeFromChanges(){this.unobserve&&this.unobserve()}onDeleteTemplateClicked(e){const t=parseInt(e.currentTarget.dataset.index),n=this.previews[t];URL.revokeObjectURL(n.img),this.previews.splice(t,1),this.props.templateLoader.remove(t)}onDownloadTemplateClicked(e){return E(this,void 0,void 0,(function*(){const t=parseInt(e.currentTarget.dataset.index),n=yield Object(O.d)(this.props.templateLoader,t);Object(k.b)(n,"template-"+(t+1)+".watermarkly",!0)}))}updatePreviews(){return E(this,void 0,void 0,(function*(){const e=this.props.templateLoader;if(e){const t=yield e.previews();this.setPreviews(t)}else this.setPreviews([])}))}setPreviews(e){for(let e=this.previews.length-1;e>=0;e--)URL.revokeObjectURL(this.previews[e].img);this.previews.splice(0,this.previews.length);for(let t=0;t<e.length;t++)this.previews.push({img:URL.createObjectURL(e[t].blob),clickHandler:this.props.onPreviewClicked?()=>{this.props.onPreviewClicked(t)}:null,synced:e[t].synced})}};j([l.l.shallow],I.prototype,"previews",void 0),j([l.f],I.prototype,"visible",null),j([l.c],I.prototype,"setPreviews",null),I=j([r.a],I);let L=class extends I{render(){return s.createElement("div",{className:Object(a.x)("templates-component",this.visible&&"visible")},super.render())}};L=j([r.a],L);var z=n(28),M=n.n(z),T=n(60),N=n(20),D=n(8),R=n(56),B=n(23),F=n(17);n.d(t,"b",(function(){return K})),n.d(t,"c",(function(){return q})),n.d(t,"a",(function(){return G}));var H=function(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},V=function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function r(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,a)}l((i=i.apply(e,t||[])).next())}))};n(72);const Z=n(74),U=n(75),A=n(76);class K{constructor(e,t){this.onlyScaleEditor=!1,this.onlyOpacityEditor=!1,this.allowSelection=!0,this.isTouch=a.Z,this.isMobile=a.V,this.snappedZones=[],this._watchChanges=!1,this.loadSettings=this.loadSettings.bind(this),this.saveProxies=this.saveProxies.bind(this),this.saveSettings=this.saveSettings.bind(this),this.reconsiderPreview=this.reconsiderPreview.bind(this),this.getProxyDraggingImpl=this.getProxyDraggingImpl.bind(this),this.task=e,this._selectedProxyIndex=-1,this.proxies=[],this.containerSize=new a.i,this.imageSize=new a.i,this._loadingCounter=0,this.watermarkHighlights=[],this.pendingHighlightItems=!1,this.imagePreviewIndex=0,this._imageIndex=0,this.saveSettingsFrequency=void 0===t?2e3:t,this.draggingImplementations=new WeakMap}get isLoading(){return this._loadingCounter>0}get selectedProxyIndex(){return this._selectedProxyIndex}set selectedProxyIndex(e){this.allowSelection?this._selectedProxyIndex=e:this._selectedProxyIndex=-1}get selectedProxy(){return this.proxies[this.selectedProxyIndex]||null}set selectedProxy(e){const t=this.selectedProxy;if(t){const e=this.imageSize,n=new a.g(0,0,e.width,e.height);if(t.item.tile!==o.h.none||t.bounds.intersect(n)){if(t.item.tile!==o.h.none){const n=Object(N.g)(t,e);if(n.length>0){const i=e.width/2,o=e.height/2;let s=n[0],r=s.distanceTo(i,o);for(let e=1,t=n.length;e<t;e++){const t=n[e],a=t.distanceTo(i,o);a<r&&(s=t,r=a)}t.bounds=s.toRect()}}}else t.bounds=t.bounds.bringTo(n)}this.selectedProxyIndex=e?this.proxies.indexOf(e):-1}get isDragging(){for(let e=this.proxies.length-1;e>=0;e--)if(this.proxies[e].dragging)return!0;return!1}get imageIndex(){return this._imageIndex}setImageIndex(e){return e=Object(a.ob)(e,0,this.task.imageCount-1),this._imageIndex!=e?(this.saveSettings(),this._imageIndex=e,this.proxies=[],this.imageSize=new a.i,this.reconsiderPreview(this.containerSize)):Promise.resolve()}saveProxies(){this.imageSize.empty||this.task.fromProxies(this.imageSize,this.proxies,this.imageIndex)}saveSettings(){this.isDragging||this.saveProxies()}beginLoading(){this._loadingCounter++}endLoading(){if(this._loadingCounter--,this._loadingCounter<0)throw new Error("Unpaired endLoading call")}reconsiderPreview(e){return V(this,void 0,void 0,(function*(){const t=e.width,n=e.height,i=this.task;if(this.saveProxies(),i.images.length>0&&t>0&&n>0&&(this.loadedPreview!=i.images[this.imageIndex]||!this.containerSize.equals(e)))if(e.width>this.containerSize.width||e.height>this.containerSize.height||this.loadedPreview!=i.images[this.imageIndex]){const o=this.containerSize,s=this.loadedPreview;Object(l.n)(()=>{this.containerSize=e.clone(),this.loadedPreview=i.images[this.imageIndex],this.snappedZones=[],this.beginLoading()});try{const o=yield 0===this.imageIndex?i.firstImagePreview(t,n):i.imagePreview(this.imageIndex,t,n);this.imagePreview&&window.URL.revokeObjectURL(this.imagePreview),Object(l.n)(()=>{this.imagePreview=window.URL.createObjectURL(o.blob),this.imageSize=o.size.fit(e.width,e.height),this.getProxiesFromTask()})}catch(e){Object(l.n)(()=>{this.containerSize=o,this.loadedPreview=s});const t=new Error("task.firstImagePreview failed: "+e);throw Object(a.mb)(t,!0),t}finally{this.endLoading()}}else Object(l.n)(()=>{this.imageSize=this.imageSize.fit(e.width,e.height),this.containerSize=e.clone(),this.getProxiesFromTask()});this.pendingHighlightItems&&(this.pendingHighlightItems=!1,yield Object(a.B)(1500),this.highlightItems())}))}getProxiesFromTask(){this.proxies=this.imageSize.empty?[]:this.task.toProxies(this.imageSize,!0,this.imageIndex)}removeProxy(e){this.selectedProxy==e&&(this.selectedProxy=null);const t=this.proxies.slice();t.splice(t.indexOf(e),1),this.proxies=t}removeAllProxies(){this.selectedProxy=null,this.proxies=[]}addProxy(e){const t=this.proxies.slice();t.push(e),this.proxies=t,this.selectedProxy=e}addText(){return new Promise(e=>{if(this.proxies.length>=this.task.limits.items)return Object(p.f)(this.task),void e();const t=new o.i({configuringInEditor:!0,bounds:new a.g((this.imageSize.width-60)/2,(this.imageSize.height-30)/2,60,30),item:new o.g({filter:"shadow-2"})});let n=Object(l.m)(t,"bounds",Object(l.c)("center text item",()=>{n(),n=null;const i=.1*this.imageSize.min/Math.min(t.bounds.width,t.bounds.height);t.bounds=new a.g((this.imageSize.width-t.bounds.width*i)/2,(this.imageSize.height-t.bounds.height*i)/2,t.bounds.width*i,t.bounds.height*i),t.scale=i,t.configuringInEditor=!1,this.selectedProxy==t&&e()}));this.addProxy(t),null==n&&e()})}addLogo(e){return V(this,void 0,void 0,(function*(){if(this.proxies.length>=this.task.limits.items)Object(p.f)(this.task);else try{const t=yield Object(m.g)(e.currentTarget,!1,!0);if(t&&1==t.length){let e,n,i;if(Object(R.a)(t[0])){e=new o.b({char:t[0],filter:"shadow-2"});const s=yield Object(N.e)(e);n=s.width,i=s.height}else{let s=yield Object(B.d)(t);const r=yield s[0].loadBytes();e=yield o.d.fromBytes(r);const a=e.img;n=a.width,i=a.height}let s=1,r=Math.min(this.imageSize.width,this.imageSize.height)/3;const l=Math.max(n,i);l>r?(s=r/l,n*=s,i*=s):l<r/5&&(s=r/5/l,n*=s,i*=s);const c=new o.i({bounds:new a.g((this.imageSize.width-n)/2,(this.imageSize.height-i)/2,n,i),scale:s,item:e});this.addProxy(c)}}catch(e){alert("It seems that we cannot load this image. Please try another one.");const t=new Error("Adding logo failed: "+e);Object(a.mb)(t,!0)}}))}get watchChanges(){return this._watchChanges}set watchChanges(e){this._watchChanges!=e&&(this._watchChanges=e,e?0===this.saveSettingsFrequency?this.taskObserverDisposer=Object(l.d)("save proxies to task",this.saveSettings):this.taskObserverDisposer=Object(l.e)("save proxies to task",this.saveSettings,this.saveSettingsFrequency):(this.taskObserverDisposer&&this.taskObserverDisposer(),this.taskObserverDisposer=null))}highlightItems(){this.imagePreview?(this.watermarkHighlights=this.proxies.map(e=>({rect:e.bounds.grow(10,10),rotation:e.item.rotation})),setTimeout(()=>{this.watermarkHighlights=[]},1500)):this.pendingHighlightItems=!0}loadSettings(e){return V(this,void 0,void 0,(function*(){this.selectedProxyIndex=-1,yield this.task.loadSettings(e),Object(l.n)(()=>{this.getProxiesFromTask(),this.highlightItems()})}))}selectProxyAsync(e){setTimeout(()=>{this.selectedProxy=e},1)}setSnappedZones(e){this.snappedZones.length>0&&this.snappedZones.splice(0,this.snappedZones.length),e&&e.length>0&&this.snappedZones.push.apply(this.snappedZones,e)}getProxyDraggingImpl(e){let t=this.draggingImplementations.get(e);if(!t){const i=25;let s,r,c,d,h,p=!1,u=!1,g=[];function n(e,t,n){if((!p||!u)&&e.distanceToPt(h[t],h[n])<=i){const i=e.snap(h[t],h[n]);i.snappedX==p&&i.snappedY==u||(h[t]=i.x,h[n]=i.y,p=p||i.snappedX,u=u||i.snappedY,(i.snappedX||i.snappedY)&&g.push(e))}}t=new m.a({onDragStart:()=>{const t=this.proxies,n=this.imageSize;if(s=e.bounds.clone(),h||(h=new a.c),r=e.bounds.centerX,c=e.bounds.centerY,e.dragging=!0,e.item.tile===o.h.none){const i=n.min/40;if(d=[new m.b(0,0,n.width-1,0,!1,!0),new m.b(0,n.height-1,n.width-1,n.height-1,!1,!0),new m.b(0,0,0,n.height-1,!0,!1),new m.b(n.width-1,0,n.width-1,n.height-1,!0,!1),new m.b(i,i,n.width-i,i,!1,!0),new m.b(i,n.height-i,n.width-i,n.height-i,!1,!0),new m.b(i,i,i,n.height-i,!0,!1),new m.b(n.width-i,i,n.width-i,n.height-i,!0,!1),new m.b(n.width/2,0,n.width/2,n.height-1,!0,!1),new m.b(0,n.height/2,n.width-1,n.height/2,!1,!0)],t.length>1)for(let i=t.length-1;i>=0;i--){const o=t[i];if(o!==e){const e=o.bounds;d.push(new m.b(0,e.centerY,n.width,e.centerY,!1,!0),new m.b(0,e.y,n.width,e.y,!1,!0),new m.b(0,e.bottom,n.width,e.bottom,!1,!0),new m.b(e.centerX,0,e.centerX,n.height-1,!0,!1),new m.b(e.x,0,e.x,n.height-1,!0,!1),new m.b(e.right,0,e.right,n.height-1,!0,!1))}}}else d=void 0;this.snappedZones=[]},onDragEnd:()=>{e.dragging=!1,Math.abs(e.bounds.centerX-r)<3&&Math.abs(e.bounds.centerY-c)<3&&this.selectProxyAsync(e),this.snappedZones=[]},canStartDragging:()=>this.allowSelection,onDrag:Object(l.c)((t,i,o,r,a)=>{h.assignFrom(s),h.x+=t,h.y+=i;const l=this.imageSize;if(h.x=Math.max(-s.width/2,h.x),h.x=Math.min(l.width-s.width/2,h.x),h.y=Math.max(-s.height/2,h.y),h.y=Math.min(l.height-s.height/2,h.y),g.length>0&&g.splice(0,g.length),d&&d.length>0&&!o&&!a){p=!1,u=!1;for(let e=0,t=d.length;e<t;e++){const t=d[e];if(n(t,"centerX","centerY"),n(t,"x","y"),n(t,"x","centerY"),n(t,"x","bottom"),n(t,"centerX","y"),n(t,"centerX","bottom"),n(t,"right","y"),n(t,"right","centerY"),n(t,"right","bottom"),p&&u)break}}this.setSnappedZones(g),e.bounds=0!=t||0!=i?h.toRect():s})}),this.draggingImplementations.set(e,t)}return t}}H([l.l.ref],K.prototype,"proxies",void 0),H([l.l],K.prototype,"imageSize",void 0),H([l.l],K.prototype,"imagePreview",void 0),H([l.l],K.prototype,"_selectedProxyIndex",void 0),H([l.l],K.prototype,"_loadingCounter",void 0),H([l.l.shallow],K.prototype,"watermarkHighlights",void 0),H([l.l.shallow],K.prototype,"snappedZones",void 0),H([l.f],K.prototype,"isLoading",null),H([l.f],K.prototype,"selectedProxy",null),H([l.f],K.prototype,"isDragging",null),H([l.c.bound],K.prototype,"beginLoading",null),H([l.c.bound],K.prototype,"endLoading",null),H([l.c.bound],K.prototype,"removeProxy",null),H([l.c.bound],K.prototype,"removeAllProxies",null),H([l.c.bound],K.prototype,"addProxy",null),H([l.c.bound],K.prototype,"addText",null),H([l.c.bound],K.prototype,"addLogo",null),H([l.c.bound],K.prototype,"highlightItems",null),H([l.c.bound],K.prototype,"setSnappedZones",null);const W=(()=>{let e=0;const t=new WeakMap;return n=>(t.has(n)||t.set(n,++e),t.get(n))})();function q(e,t,n,i,r){const l=[],d=[];for(let h=0,m=e.length;h<m;h++){const m=e[h],p=m.item,u=W(p),g="item-filter-"+u+"-"+p.filter,b=a.X?"item-component-"+u+"-"+g:"item-component-"+u;let f;const y=Object(c.b)(p);if(y)if(y.color instanceof D.a)f=y.color.hexString;else if(y.color instanceof D.b){const e="fill-"+u+"-"+y.color.id;f="url(#"+e+")",l.push(s.createElement(N.a,{key:e,id:e,gradient:y.color}))}else f="";else f="";const w={proxy:m,proxies:e,selfContained:r||!1,id:b,filterId:g,fill:f,bounds:null,selectProxy:n,rootElem:!0,imageSize:t,draggingImpl:i&&i(m)};l.push(s.createElement(o.e,{proxy:m,id:g,key:g+"-def"})),p.tile!=o.h.none?d.push(s.createElement(N.d,Object.assign({key:b},w))):d.push(s.createElement(N.b,Object.assign({key:b},w)))}return{defs:l,comps:d}}let _=class extends s.Component{render(){const e=this.props.model;if(!e.proxies)throw Error("Not-ready model");const t=q(e.proxies,e.imageSize,this.props.selectProxy,e.getProxyDraggingImpl);return s.createElement(s.Fragment,null,s.createElement("defs",null,t.defs),t.comps)}};_=H([r.a],_);let Y=class extends s.Component{constructor(e){super(e),this.minSize=50}render(){const e=this.props.model;if(e.isDragging)return s.createElement(s.Fragment,null);const t=[];for(let n=0,i=e.proxies.length;n<i;n++){const i=e.proxies[n];if(i.bounds.width>=this.minSize&&i.bounds.height>=this.minSize)continue;const r=Math.max(0,(this.minSize-i.bounds.width)/2),l=Math.max(0,(this.minSize-i.bounds.height)/2),c=e.getProxyDraggingImpl(i);if(i.item.tile===o.h.none){const e=i.bounds.grow(r,l);t.push(s.createElement("rect",Object.assign({key:"extended-snap-zone-"+n,x:e.x,y:e.y,width:e.width,height:e.height},c.events,{fill:"transparent"})))}else{const o=Object(N.g)(i,e.imageSize),d=new a.c;for(let e=0,i=o.length;e<i&&(d.assignFrom(o[e]),!d.empty);e++)d.grow(r,l),t.push(s.createElement("rect",Object.assign({key:"extended-snap-zone-"+n+"-"+e,x:d.x,y:d.y,width:d.width,height:d.height},c.events,{fill:"transparent"})))}}return s.createElement(s.Fragment,null,t)}};Y=H([r.a],Y);let G=class extends s.Component{constructor(e){super(e),this.reconsiderPreview=this.reconsiderPreview.bind(this),this.renderHighlight=this.renderHighlight.bind(this),this.onImageClicked=this.onImageClicked.bind(this),this.setSurfaceContainerElem=this.setSurfaceContainerElem.bind(this),this.onTemplatePreviewClicked=this.onTemplatePreviewClicked.bind(this),this.onWindowResize=this.onWindowResize.bind(this),this.onFileDrop=this.onFileDrop.bind(this),this.delayedReconsiderPreview=Object(a.C)(this.reconsiderPreview,1e3),this.dropHandler=new T.b(this.onFileDrop),e.model.isMobile||this.props.floatingOptions||(this.itemOptionsWidth=0,function(){return V(this,void 0,void 0,(function*(){const e=document.createElement("div");Object.assign(e.style,{position:"absolute",left:"-500px",top:"-500px",width:"500px",height:"500px",opacity:1}),e.className="watermarkly-component measure-options-component",document.body.append(e);const t=document.createElement("div");Object.assign(t.style,{position:"absolute",left:"0px",top:"0px",width:"100%",height:"100%"}),t.className="watermark-editor",e.append(t);const n=new i.b;n.items.push(new o.g,new o.d);const r=new K(n);function a(e){return new Promise(n=>{r.selectedProxyIndex=e,F.render(s.createElement(J,{model:r,floating:!1}),t,()=>{let e=t.querySelector(".item-options");n(e.offsetWidth+2)})})}r.proxies=[new o.i({item:n.items[0]}),new o.i({item:n.items[1]})];try{let t=yield a(0),n=yield a(1);return Math.max(t,n)}finally{e.remove()}}))}().then(e=>{this.itemOptionsWidth=e}))}get isDragging(){return this.props.model.isDragging}get templatesVisible(){const e=this.props.model;return!e.isLoading&&e.imageSize.width>0&&0==e.proxies.length}get surfaceContainerSize(){let e=this.surfaceContainerElem?this.surfaceContainerElem.offsetWidth:0,t=this.surfaceContainerElem?this.surfaceContainerElem.offsetHeight:0;if(this.props.model.isMobile&&!1!==this.props.reduceSurfaceSizeByActionsSize&&this.mobileActionsContainer){let e=this.mobileActionsContainer.getBoundingClientRect(),n=this.surfaceContainerElem.getBoundingClientRect();n.top<e.top&&(t=e.top-n.top-10)}return new a.i(e,t)}get isPannedToView(){const e=this.props,t=e.model,n=e.floatingOptions;return!1!==e.panToViewSelectedProxy&&t.isMobile&&X(t,n)}render(){const e=this.props.model,t=this.props.floatingOptions,n=e.imageSize,i={width:n.width,height:n.height},o=t?null:{right:this.itemOptionsWidth},r=this.props.templateLoader;if(!e.proxies)throw Error("Non-ready model");X(e,t);const l=Object(a.x)("watermark-editor",e.isMobile&&"mobile",!1===this.props.panToViewSelectedProxy&&"no-pan-to-view");return s.createElement("div",Object.assign({className:l},this.dropHandler.eventHandlers),s.createElement("div",{className:"surface-container",style:o,ref:this.setSurfaceContainerElem},s.createElement("div",{className:"deselect-cover",onClick:this.onImageClicked}),s.createElement("div",{className:"surface",style:i},s.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:n.width,height:n.height},s.createElement("image",{href:e.imagePreview,x:"0",y:"0",width:n.width+"px",height:n.height+"px",onClick:this.onImageClicked,className:Object(a.x)("image-preview",n.width>0&&"visible")}),e.watermarkHighlights.length>0&&e.watermarkHighlights.map(this.renderHighlight),s.createElement(N.c,{owner:e}),s.createElement(Y,{model:e}),s.createElement(_,{model:e,selectProxy:e.selectProxyAsync}),s.createElement(Q,{model:e})))),s.createElement(J,{model:e,width:this.itemOptionsWidth,floating:t&&!e.isMobile,templateLoader:r,onTemplatePreviewClicked:this.onTemplatePreviewClicked,visible:this.templatesVisible}),e.isLoading&&s.createElement(y.b,null),!!r&&(t||e.isMobile)&&s.createElement(L,{templateLoader:r,visible:this.templatesVisible,vertical:!1,onPreviewClicked:this.onTemplatePreviewClicked}),s.createElement(T.a,{dropHandler:this.dropHandler}))}reconsiderPreview(){return this.props.model.reconsiderPreview(this.surfaceContainerSize)}componentDidMount(){const e=this.props.model;window.addEventListener("resize",this.onWindowResize),e.watchChanges=!0,setTimeout(()=>{this.reconsiderPreview()},1)}componentWillUnmount(){window.removeEventListener("resize",this.onWindowResize),this.props.model.selectedProxy=null,this.props.model.watchChanges=!1}componentDidUpdate(){this.panToViewSelectedProxy()}onWindowResize(){this.isPannedToView?this.panToViewSelectedProxy():this.delayedReconsiderPreview()}panToViewSelectedProxy(){const e=this.props.model,t=this.props.floatingOptions;if(!(!e.isMobile||!1===this.props.panToViewSelectedProxy||e.selectedProxy&&e.selectedProxy.dragging))if(X(e,t)){const t=e.imageSize,n=e.selectedProxy.bounds;if(t.height<0||this.surfaceContainerElem.offsetHeight<150||this.itemOptionsElem.offsetHeight<100)return void setTimeout(()=>this.panToViewSelectedProxy(),1);const i=this.surfaceContainerElem.offsetHeight-this.itemOptionsElem.offsetHeight;let o;o=n.centerY<t.height/3||t.height<i?0:n.centerY>2*t.height/3?-t.height+i:(i-t.height)/2,this.surfaceElem.style.top=o+"px"}else this.surfaceElem.style.top&&(this.surfaceElem.style.top="")}onImageClicked(){this.props.model.selectedProxy=null}renderHighlight(e,t){const n=e.rect,i=Object(N.f)(e.rotation,n);return s.createElement("rect",{x:n.x,y:n.y,rx:5,ry:5,transform:i,width:n.width,height:n.height,fill:"#ffffff",key:"watermark-highlight-"+t},s.createElement("animate",{attributeName:"opacity",values:"0;1;0",dur:"300ms",repeatCount:"indefinite"}))}setSurfaceContainerElem(e){this.surfaceContainerElem=e,this.surfaceElem=e?e.querySelector(".surface"):null,this.itemOptionsElem=e?e.parentNode.querySelector(".item-options"):null,this.mobileActionsContainer=document.body.querySelector(".wizard .mobile-actions-container")}onTemplatePreviewClicked(e){return V(this,void 0,void 0,(function*(){yield this.loadTemplate(e)}))}loadTemplate(e){return V(this,void 0,void 0,(function*(){const t=yield this.props.templateLoader.get(e);yield this.props.model.loadSettings(t)}))}onFileDrop(e){return V(this,void 0,void 0,(function*(){let t=!1;const n=this.props.templateLoader;for(let i=0;i<e.length;i++){if("file"===e[i].kind){const o=e[i].getAsFile();o&&(o.name.endsWith(".watermarkly")||o.name.endsWith(".json"))&&(yield Object(O.e)(n,o),t=!0)}}if(t){(yield n.count())>0&&(yield this.loadTemplate(0))}}))}};function X(e,t){if(e.isMobile||t){const t=e.selectedProxy;return!!t&&!t.dragging&&e.imageSize.width>0}return e.imageSize.width>0}H([l.l],G.prototype,"itemOptionsWidth",void 0),G=H([r.a],G);let J=class extends s.Component{constructor(e){super(e),this.pendingValidatePosition=0,this.userPositionSet=!1,this.positionSetFor=null,this.constraintsSetFor=null,this.scaleConstraints={anchorX:o.a.begin,anchorY:o.a.begin},this.onTextChange=this.onTextChange.bind(this),this.onInputFocused=this.onInputFocused.bind(this),this.onLineHeightChange=this.onLineHeightChange.bind(this),this.onChangeColor=this.onChangeColor.bind(this),this.onFontChange=this.onFontChange.bind(this),this.onRemoveClicked=this.onRemoveClicked.bind(this),this.onRemoveBackgroundClicked=this.onRemoveBackgroundClicked.bind(this),this.validatePosition=this.validatePosition.bind(this),this.setRef=this.setRef.bind(this),this.onAlignmentClick=this.onAlignmentClick.bind(this),e.floating&&(this.draggingImpl=this.createDraggingImpl()),e.floating||Object(u.e)()}get proxy(){return this.props.model.selectedProxy}get surfaceContainer(){if(!this._surfaceContainer&&this.elem){let e=this.elem.parentElement.querySelector(".surface-container");this._surfaceContainer=e}return this._surfaceContainer}get position(){const e=this.elem;return e&&""!=e.style.left?new a.d(parseInt(e.style.left),parseInt(e.style.top)):null}set position(e){const t=this.elem;if(t){const n=this.surfaceContainer;e&&(e.x+t.offsetWidth>n.offsetWidth-1&&(e.x=n.offsetWidth-t.offsetWidth-1),e.y+t.offsetHeight>n.offsetHeight-1&&(e.y=n.offsetHeight-t.offsetHeight-1),e.x<0&&(e.x=0),e.y<0&&(e.y=0));let i=this.position;if(!i||!i.equals(e))if(e)t.style.left=e.x+"px",t.style.top=e.y+"px";else{if(this.userPositionSet)throw new Error("Cannot erase user set position");t.style.left="",t.style.top=""}}}get isVisible(){return!!this.elem&&X(this.props.model,this.props.floating)}createDraggingImpl(){let e;return new m.a({onDragStart:()=>{this.elem.classList.add("dragging"),e=this.position},onDragEnd:()=>{this.elem.classList.remove("dragging")},onDrag:(t,n)=>{0!=t||0!=n?(this.position=e.offset(t,n),this.userPositionSet=!0):(this.position=e,this.userPositionSet=!1)},canStartDragging:e=>!(this.props.model.isMobile||!e||e!==this.elem&&"LABEL"!==e.tagName)})}render(){let e;const t=this.props,n=t.model.proxies;if(t.floating){let t=this.position;this.proxy&&!t&&(t=this.calculatePosition(this.proxy,300,300)),t&&(e={left:t.x+"px",top:t.y+"px"})}!t.floating&&t.width>0&&(e?e.width=t.width:e={width:t.width});const i=Object(a.x)("item-options",!this.proxy&&n.length>0&&"empty",!this.proxy&&0==n.length&&"empty-has-no-watermark",!this.isVisible&&"hidden",t.model.onlyScaleEditor&&"only-scale-editor",t.floating&&"floating",(t.floating||t.model.isMobile)&&"with-shadow");let o=this.draggingImpl&&this.draggingImpl.events;return s.createElement("div",Object.assign({className:i,style:e,ref:this.setRef},o),this.renderProxyOptions(this.proxy))}componentDidUpdate(){this.validatePosition(),this.updateScaleConstraints(),this.isVisible||(this.userPositionSet=!1,this.constraintsSetFor=null)}updateScaleConstraints(){const e=this.props.model,t=e.selectedProxy,n=e.imageSize;this.constraintsSetFor!==t&&(this.constraintsSetFor=t,t&&(this.scaleConstraints.anchorX=Object(o.j)(t.bounds.centerX,n.width),this.scaleConstraints.anchorY=Object(o.j)(t.bounds.centerY,n.height)))}validatePosition(){const e=this.elem,t=this.props.model.selectedProxy,n=this.isVisible;if(!e||n&&(e.offsetWidth<200||t&&(!t.bounds||t.configuringInEditor)))this.pendingValidatePosition||(this.pendingValidatePosition=setTimeout(()=>this.validatePosition(),1));else if(this.pendingValidatePosition&&clearTimeout(this.pendingValidatePosition),this.pendingValidatePosition=0,this.props.floating)if(n){if(this.positionSetFor!==t)if(this.positionSetFor=t,this.userPositionSet)this.position=this.position;else{e.style.left="",e.style.top="";const n=e.offsetWidth,i=e.offsetHeight;this.position=this.calculatePosition(t,n,i)}}else this.positionSetFor=null}calculatePosition(e,t,n){if(e.bounds.empty)return new a.d;const i=this.props.model.imageSize,o=this.surfaceContainer,s=o?o.offsetWidth:i.width,r=o?o.offsetHeight:i.height,l=(s-i.width)/2,c=(r-i.height)/2,d=r-e.bounds.bottom-c,h=e.bounds.y+c,m=s-e.bounds.right-l,p=e.bounds.x+l;let u,g;return d>=n?(u=e.bounds.x+l,g=e.bounds.bottom+c,d>n&&(g+=Math.min(20,d-n))):h>=n?(u=e.bounds.x+l,g=e.bounds.y-n+c,h>n&&(g-=Math.min(20,h-n))):m>=t?(u=e.bounds.right+l,m>t&&(u+=Math.min(20,m-t)),g=e.bounds.y+c):p>=t?(u=e.bounds.x-t+l,p>t&&(u-=Math.min(20,p-t)),g=e.bounds.y+c):(u=e.bounds.right+l,m>t&&(u+=Math.min(20,m-t)),g=e.bounds.y+c),new a.d(u,g)}onChangeColor(e){const t=this.props.model.selectedProxy,n=Object(c.b)(t&&t.item);n&&(n.allowNullColor&&null===e?n.color=null:n.color=e)}onTextChange(e){const t=this.props.model.selectedProxy;t.item instanceof o.g&&(t.item.text=e.target.value)}onInputFocused(e){if(this.props.model.isMobile){const t=e.target,n=document.createElement("div"),i=()=>{n.removeEventListener("click",i,!1),t.removeEventListener("focusout",i,!1),n.remove()};Object.assign(n.style,{position:"absolute",left:"0",top:"0",right:"0",bottom:"0",zIndex:"1"}),n.addEventListener("click",i,!1),t.addEventListener("focusout",i,!1),document.body.appendChild(n)}}onLineHeightChange(e){const t=this.props.model.selectedProxy;t.item instanceof o.g&&(t.item.lineHeight=e/50+1)}onAlignmentClick(e){const t=this.props.model.selectedProxy;if(t.item instanceof o.g)switch(e){case 0:t.item.alignment=o.c.left;break;case 1:t.item.alignment=o.c.center;break;case 2:t.item.alignment=o.c.right}}onFontChange(e){return V(this,void 0,void 0,(function*(){if(e)if(Object(a.v)(),b.l.get()!=b.s&&e.edition>b.l.get())Object(p.c)(e.edition);else if(e.family){const t=this.props.model;t.beginLoading();try{yield function(e,t){const n=e.map(e=>e.item.fontName);t&&n.push(t);return Object(u.g)(n)}(t.proxies,e.family)}finally{t.selectedProxy.item.fontName=e.family,t.endLoading()}}}))}onRemoveClicked(){this.props.model.selectedProxy?this.props.model.removeProxy(this.props.model.selectedProxy):this.props.model.removeAllProxies()}onRemoveBackgroundClicked(){this.proxy.item.removeBackground()}renderProxyOptions(e){const t=this.props,n=t.model,i=t.templateLoader,r=n.imageSize,a=n.onlyScaleEditor,l=n.onlyOpacityEditor;if(e&&a&&l)return s.createElement(s.Fragment,null,s.createElement("label",null,Object(f.c)("size")," ",s.createElement(d.c,{proxy:e,imageSize:r,constraints:this.scaleConstraints})),s.createElement("label",null,Object(f.c)("opacity")," ",s.createElement(d.a,{proxy:e})));if(e&&e.item instanceof o.g){const t=e.item.text.lineBreaksCount()+1;let n=0;switch(e.item.alignment){case o.c.center:n=1;break;case o.c.right:n=2}return s.createElement(s.Fragment,null,s.createElement("label",null,Object(f.c)("text")," ",s.createElement("textarea",{onChange:this.onTextChange,onFocus:this.onInputFocused,style:t>1?{height:20*t+"px"}:{},value:e.item.text})),s.createElement(M.a,{transitionEnter:!0,transitionLeave:!0,transitionName:"item-option",transitionEnterTimeout:300,transitionLeaveTimeout:250},t>1&&s.createElement("label",null,Object(f.c)("horizontal-alignment"),s.createElement(v.a,{selectedIndex:n,buttons:[{children:s.createElement(x.a,{src:Z})},{children:s.createElement(x.a,{src:U})},{children:s.createElement(x.a,{src:A})}],onClick:this.onAlignmentClick}))),s.createElement(M.a,{transitionEnter:!0,transitionLeave:!0,transitionName:"item-option",transitionEnterTimeout:300,transitionLeaveTimeout:250},t>1&&s.createElement("label",null,Object(f.c)("line-height"),s.createElement(w.a,{value:50*(e.item.lineHeight-1),onChange:this.onLineHeightChange}))),s.createElement("label",null,Object(f.c)("font")," ",s.createElement(h.a,{textObject:e.item,onChange:this.onFontChange})),s.createElement("label",null,Object(f.c)("color"),s.createElement("div",{className:"short-container"},s.createElement(c.a,{obj:e.item,onChange:this.onChangeColor}))),s.createElement("label",null,Object(f.c)("size")," ",s.createElement(d.c,{proxy:e,imageSize:r,constraints:this.scaleConstraints})),s.createElement("label",null,Object(f.c)("tile")," ",s.createElement(d.e,{proxy:e,imageSize:r})),s.createElement(M.a,{transitionEnter:!0,transitionLeave:!0,transitionName:"item-option",transitionEnterTimeout:300,transitionLeaveTimeout:250},e.item.tile!=o.h.none&&s.createElement("label",null,"Span ",s.createElement(d.d,{proxy:e,imageSize:r}))),s.createElement("label",null,Object(f.c)("opacity")," ",s.createElement(d.a,{proxy:e})),s.createElement("label",null,Object(f.c)("rotation")," ",s.createElement(d.b,{proxy:e})),s.createElement("label",null,Object(f.c)("effect")," ",s.createElement(g.a,{proxy:e})),s.createElement("label",null,s.createElement("button",{className:"remove-button",onClick:this.onRemoveClicked},Object(f.c)("remove-text-action"))))}return e&&e.item instanceof o.d?s.createElement(s.Fragment,null,e.item.opaque&&s.createElement("button",{className:"remove-background",onClick:this.onRemoveBackgroundClicked},Object(f.c)("remove-background-action")),!e.item.opaque&&s.createElement("label",null,Object(f.c)("color"),s.createElement("div",{className:"short-container"},s.createElement(c.a,{obj:e.item,onChange:this.onChangeColor}))),s.createElement("label",null,Object(f.c)("size")," ",s.createElement(d.c,{proxy:e,imageSize:r,constraints:this.scaleConstraints})),s.createElement("label",null,Object(f.c)("tile")," ",s.createElement(d.e,{proxy:e,imageSize:r})),s.createElement(M.a,{transitionEnter:!0,transitionLeave:!0,transitionName:"item-option",transitionEnterTimeout:300,transitionLeaveTimeout:250},e.item.tile!=o.h.none&&s.createElement("label",null,"Span ",s.createElement(d.d,{proxy:e,imageSize:r}))),s.createElement("label",null,Object(f.c)("opacity")," ",s.createElement(d.a,{proxy:e})),s.createElement("label",null,Object(f.c)("rotation")," ",s.createElement(d.b,{proxy:e})),s.createElement("label",null,Object(f.c)("effect")," ",s.createElement(g.a,{proxy:e})),s.createElement("label",null,s.createElement("button",{className:"remove-button",onClick:this.onRemoveClicked},Object(f.c)("remove-logo-action")))):e&&e.item instanceof o.b?s.createElement(s.Fragment,null,s.createElement("label",null,Object(f.c)("color"),s.createElement("div",{className:"short-container"},s.createElement(c.a,{obj:e.item,onChange:this.onChangeColor}))),s.createElement("label",null,Object(f.c)("size")," ",s.createElement(d.c,{proxy:e,imageSize:r,constraints:this.scaleConstraints})),s.createElement("label",null,Object(f.c)("tile")," ",s.createElement(d.e,{proxy:e,imageSize:r})),s.createElement(M.a,{transitionEnter:!0,transitionLeave:!0,transitionName:"item-option",transitionEnterTimeout:300,transitionLeaveTimeout:250},e.item.tile!=o.h.none&&s.createElement("label",null,"Span ",s.createElement(d.d,{proxy:e,imageSize:r}))),s.createElement("label",null,Object(f.c)("opacity")," ",s.createElement(d.a,{proxy:e})),s.createElement("label",null,Object(f.c)("rotation")," ",s.createElement(d.b,{proxy:e})),s.createElement("label",null,Object(f.c)("effect")," ",s.createElement(g.a,{proxy:e})),s.createElement("label",null,s.createElement("button",{className:"remove-button",onClick:this.onRemoveClicked},Object(f.c)("remove-logo-action")))):!n.isMobile&&!e&&n.proxies.length>0&&!t.floating?s.createElement(s.Fragment,null,s.createElement("p",{className:"hint"},Object(f.c)("item-options-hint-second")),s.createElement("p",{className:"hint"},Object(f.c)("or")),s.createElement("label",null,s.createElement("button",{className:"remove-button",onClick:this.onRemoveClicked},Object(f.c)("remove-watermark-action")))):n.isMobile||e||0!==n.proxies.length?void 0:s.createElement(s.Fragment,null,s.createElement("div",{className:"arrow"},""),s.createElement("p",{className:"hint"},Object(f.c)("item-options-hint-first",Object(f.c)("add-text-action"),Object(f.c)("add-logo-action"))," "),i&&i.observableCount>0&&s.createElement(s.Fragment,null,s.createElement("div",{className:"box"},s.createElement("div",{className:"line"}),s.createElement("p",null,"or"),s.createElement("div",{className:"line"}))),s.createElement(I,{templateLoader:i,visible:!0,vertical:!0,onPreviewClicked:t.onTemplatePreviewClicked}))}setRef(e){this.elem=e,this._surfaceContainer=null}};H([l.f],J.prototype,"proxy",null),H([l.c],J.prototype,"updateScaleConstraints",null),J=H([r.a],J);let Q=class extends s.Component{constructor(e){super(e),this.bounds=new a.c}render(){const e=this.props.model.selectedProxy,t=!!e;t?(this.bounds.assignFrom(e.bounds),this.bounds.grow(3,3)):this.bounds.reset();const n=t?Object(N.f)(e.item.rotation,this.bounds):"";return s.createElement("rect",{className:"selection",transform:n,x:this.bounds.x,y:this.bounds.y,width:this.bounds.width,height:this.bounds.height})}};Q=H([r.a],Q)},42:function(e,t,n){"use strict";(function(e){n.d(t,"b",(function(){return f})),n.d(t,"a",(function(){return y}));var i=n(1),o=n(0),s=n(4),r=n(18),a=n(31),l=n(17),c=n(19),d=n(2),h=n(20),m=n(3),p=n(45),u=function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function r(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,a)}l((i=i.apply(e,t||[])).next())}))};const g=new s.g({text:Object(d.c)("nag-text").replace("{0}",i.l),filter:"shadow-2",alignment:s.c.center,positionBase:new i.i(1e3,1e3)}),b=Object(i.wb)(()=>Object(h.e)(g).then(e=>{g.position=new i.e(0,g.positionBase.width-e.width,0,g.positionBase.height-e.height)},e=>{Object(i.mb)(e,!0),g.position=new i.e(0,g.positionBase.width-100,0,g.positionBase.height-20)}));function f(t,n,s){return new Promise((r,c)=>{e(()=>{const e=document.createElement("div");l.render(function(e,t,n){const s=Object(a.c)(t,e,i.pb,null,!0);return o.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:e.width,height:e.height,textRendering:"geometricPrecision",imageRendering:"firefox"==Object(i.q)()?"auto":"optimizeQuality",colorRendering:"optimizeQuality"},o.createElement("defs",null,!!n&&o.createElement("style",{type:"text/css"},n),s.defs),s.comps)}(t,n,s),e,()=>{Object(i.lb)(e.innerHTML).then(r,c)})})})}Object(m.d)(()=>{g.text=Object(d.c)("nag-text").replace("{0}",i.l),b()});class y extends p.a{constructor(e){super(e),this.imageProcessingTimeName="image-watermarking-time"}beforeProcessing(){return u(this,void 0,void 0,(function*(){const e=this.task.items.some(e=>e instanceof s.b);this.fontsCss=yield Object(r.d)(e)}))}processImage(e){return u(this,void 0,void 0,(function*(){const t=this.task;if(this.cancelRequested)return null;let n,o,r=t.images[e];try{const a=yield r.loadBytes(),l=yield Object(i.hb)(a);if(!l||!l.width)throw new Error("Broken image");if(n=Object(c.d)(l),!n||!n.width)throw new Error("Cannot convert image to canvas");if(this.cancelRequested)return null;const d=function(e,t,n){const o=e.toProxies(new i.i(t),e.autoSize,n);if(e.limits.putNag){const e=t.width>=t.height?t.height/40:t.height/80,n=e/g.position.height(g.positionBase.height),r=n*g.position.width(g.positionBase.width);o.push(new s.i({item:g,bounds:new i.g((t.width-r)/2,t.height-2*e,r,e),scale:n,opacity:g.opacity}))}return o}(t,n,e),h=yield f(new i.i(n),d,this.fontsCss);if(this.cancelRequested)return null;n.getContext("2d").drawImage(h,0,0);const m=t.resize.targetSize(new i.i(n));return o=m.width!=n.width?yield Object(c.g)(n,m,3):n,this.cancelRequested?null:o}finally{n&&n!=o&&(n.width=0,n.height=0,n=null)}}))}}}).call(this,n(68).setImmediate)},49:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="64px" height="64px" viewBox="0 0 100 100" version="1.1"><g><circle fill="#000000" cx="50" cy="50" r="15"></circle></g></svg>'},50:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="64px" height="64px" viewBox="0 0 100 100" version="1.1"><g><circle fill="#000000" cx="25" cy="25" r="15"></circle><circle fill="#000000" cx="75" cy="25" r="15"></circle><circle fill="#000000" cx="25" cy="75" r="15"></circle><circle fill="#000000" cx="75" cy="75" r="15"></circle></g></svg>'},51:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="64px" height="64px" viewBox="0 0 100 100" version="1.1"><g><circle fill="#000000" cx="50" cy="20" r="15"></circle><circle fill="#000000" cx="20" cy="50" r="15"></circle><circle fill="#000000" cx="80" cy="50" r="15"></circle><circle fill="#000000" cx="50" cy="80" r="15"></circle></g></svg>'},52:function(e,t,n){var i=n(53);"string"==typeof i&&(i=[[e.i,i,""]]);var o={insert:"head",singleton:!1};n(16)(i,o);i.locals&&(e.exports=i.locals)},53:function(e,t,n){(e.exports=n(15)(!1)).push([e.i,".surface svg line.snap-line {\n  stroke: #C822FF;\n  stroke-width: 3px;\n  stroke-dasharray: 5, 5;\n}\n.visualwatermark .surface svg line.snap-line {\n  stroke: #3EB084;\n}\n",""])},54:function(e,t,n){var i=n(55);"string"==typeof i&&(i=[[e.i,i,""]]);var o={insert:"head",singleton:!1};n(16)(i,o);i.locals&&(e.exports=i.locals)},55:function(e,t,n){(e.exports=n(15)(!1)).push([e.i,".account-component .edition-name {\n  cursor: default;\n  text-transform: uppercase;\n}\n.account-component span,\n.account-component button {\n  margin: 0 5px;\n}\n.mobile .options-container .options .account-component {\n  display: flex;\n  flex-direction: column;\n}\n.mobile .options-container .options .account-component span,\n.mobile .options-container .options .account-component button {\n  margin: 10px 0 0 0;\n}\n.activate-dialog-component {\n  width: 300px;\n}\n.activate-dialog-component .header {\n  display: flex;\n  flex-direction: row;\n}\n.activate-dialog-component h1,\n.activate-dialog-component h2 {\n  margin-top: 0;\n  flex-grow: 1;\n}\n.activate-dialog-component .close-button {\n  width: 30px;\n  height: 30px;\n  margin: -15px -15px 0 0;\n}\n",""])},69:function(e,t,n){var i=n(70);"string"==typeof i&&(i=[[e.i,i,""]]);var o={insert:"head",singleton:!1};n(16)(i,o);i.locals&&(e.exports=i.locals)},70:function(e,t,n){(e.exports=n(15)(!1)).push([e.i,".templates-component {\n  position: absolute;\n  bottom: 80px;\n  left: 50%;\n  transform: translateX(-50%);\n  background-color: #ffffff;\n  border-radius: 4px;\n  box-shadow: 0 2px 10px 1px rgba(0, 0, 0, 0.2);\n  padding: 20px 10px 10px 10px;\n  transition: opacity 200ms linear;\n  opacity: 0;\n  pointer-events: none;\n  max-width: 80%;\n}\n.templates-component.visible {\n  opacity: 1;\n  pointer-events: auto;\n}\n.inline-templates-component {\n  opacity: 0;\n  pointer-events: none;\n  display: flex;\n  flex-direction: column;\n}\n.inline-templates-component h3 {\n  margin: 0 0 10px 10px;\n  font-weight: normal;\n}\n.inline-templates-component.vertical h3 {\n  margin: 0 0 10px 0;\n}\n.inline-templates-component.vertical .templates-container {\n  flex-grow: 2;\n  flex-direction: column;\n  overflow-x: hidden;\n  overflow-y: auto;\n}\n.inline-templates-component.vertical .templates-container > div.img {\n  width: 300px;\n  margin: 0 10px 10px 10px;\n  position: relative;\n}\n.inline-templates-component.vertical .templates-container > div.img:first-child {\n  margin: 10px;\n}\n.inline-templates-component .templates-container {\n  display: flex;\n  flex-direction: row;\n  overflow-x: auto;\n}\n.inline-templates-component .templates-container > div.img {\n  width: 300px;\n  margin: 10px 10px 10px 0;\n  position: relative;\n}\n.inline-templates-component .templates-container > div.img:first-child {\n  margin: 10px;\n}\n.inline-templates-component .templates-container > div.img > img {\n  width: 300px;\n  transition: box-shadow 200ms linear;\n}\n.inline-templates-component .templates-container > div.img > img:hover {\n  box-shadow: 0 2px 10px rgba(200, 34, 255, 0.6);\n}\n.inline-templates-component .templates-container > div.img > img:active {\n  box-shadow: none;\n}\n.inline-templates-component .templates-container > div.img > .delete-button,\n.inline-templates-component .templates-container > div.img > .download-button {\n  position: absolute;\n  top: 0;\n  right: 0;\n  opacity: 0;\n  pointer-events: none;\n  transition: opacity 0.1s linear, background 0.1s linear;\n  background: #F8F8F8;\n  border: 1px solid #d3d5d6;\n  padding: 4.5px;\n  width: 36px;\n  height: 36px;\n  border-radius: 18px;\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0);\n}\n.inline-templates-component .templates-container > div.img > .delete-button:not(:disabled):not(:active):hover,\n.inline-templates-component .templates-container > div.img > .download-button:not(:disabled):not(:active):hover {\n  background: #ffffff;\n}\n.inline-templates-component .templates-container > div.img > .delete-button:not(:disabled):not(:active):hover,\n.inline-templates-component .templates-container > div.img > .download-button:not(:disabled):not(:active):hover {\n  box-shadow: 0 2px 10px rgba(200, 34, 255, 0.4);\n}\n.inline-templates-component .templates-container > div.img > .delete-button.default:not(:disabled):not(:active):hover,\n.inline-templates-component .templates-container > div.img > .download-button.default:not(:disabled):not(:active):hover {\n  box-shadow: 0 4px 10px rgba(200, 34, 255, 0.4);\n}\n.inline-templates-component .templates-container > div.img > .delete-button.selected:not(:disabled):not(:active):hover,\n.inline-templates-component .templates-container > div.img > .download-button.selected:not(:disabled):not(:active):hover {\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0);\n}\n.inline-templates-component .templates-container > div.img > .sync-state {\n  position: absolute;\n  bottom: 10px;\n  left: 50%;\n  opacity: 1;\n  pointer-events: none;\n  transform: translateX(-50%);\n  width: 25.2px;\n  height: 25.2px;\n  background: #ffffff;\n  border-radius: 18px;\n}\n.inline-templates-component .templates-container > div.img > .download-button {\n  right: 40px;\n}\n.inline-templates-component .templates-container > div.img > .sync-state {\n  right: 80px;\n}\n.inline-templates-component .templates-container > div.img:hover > .delete-button,\n.inline-templates-component .templates-container > div.img:hover > .download-button,\n.inline-templates-component .templates-container > div.img:hover > .sync-state {\n  opacity: 1;\n  pointer-events: auto;\n}\n.inline-templates-component.visible {\n  opacity: 1;\n  pointer-events: auto;\n}\n.mobile .templates-component {\n  bottom: 160px;\n}\n.mobile .templates-component > .container > div.img {\n  width: 220px;\n}\n.mobile .templates-component > .container > div.img > img {\n  width: 200px;\n}\n.mobile .templates-component > .container > div.img > .delete-button,\n.mobile .templates-component > .container > div.img > .download-button {\n  opacity: 1;\n}\n",""])},71:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64" width="64px" height="64px"><linearGradient id="61KRhqZmhJddGRYRcI0Lea" x1="32" x2="32" y1="9.167" y2="54.188" gradientUnits="userSpaceOnUse" spreadMethod="reflect"><stop offset="0" stop-color="#1a6dff"></stop><stop offset="1" stop-color="#c822ff"></stop></linearGradient><path fill="url(#61KRhqZmhJddGRYRcI0Lea)" d="M61,38c0-4.357-3.502-7.912-7.838-7.998C53.714,28.746,54,27.392,54,26 c0-5.514-4.486-10-10-10c-2.836,0-5.471,1.185-7.335,3.206C35.397,13.938,30.632,10,25,10c-6.617,0-12,5.383-12,12 c0,1.373,0.238,2.737,0.697,4.025C7.921,25.616,3,30.256,3,36c0,5.208,4.005,9.495,9.097,9.954C12.544,48.256,14.57,50,17,50h7v-2 h-7c-1.302,0-2.401-0.838-2.815-2H22v-2h-9c-4.411,0-8-3.589-8-8s3.589-8,8-8c0.695,0,1.406,0.099,2.114,0.293l2.292,0.628 l-1.153-2.078C15.434,25.365,15,23.69,15,22c0-5.514,4.486-10,10-10c5.462,0,9.945,4.445,9.995,9.908l0.037,4.057l1.853-3.608 C38.265,19.669,40.991,18,44,18c4.411,0,8,3.589,8,8c0,1.664-0.513,3.265-1.483,4.629l-1.562,2.195l2.615-0.645 C55.512,31.215,59,34.229,59,38c0,3.309-2.691,6-6,6H42v2h9.816c-0.415,1.162-1.514,2-2.816,2h-9v2h9 c2.433,0,4.46-1.749,4.904-4.055C57.891,45.494,61,42.105,61,38z"></path><linearGradient id="61KRhqZmhJddGRYRcI0Leb" x1="32" x2="32" y1="9.167" y2="54.188" gradientUnits="userSpaceOnUse" spreadMethod="reflect"><stop offset="0" stop-color="#1a6dff"></stop><stop offset="1" stop-color="#c822ff"></stop></linearGradient><path fill="url(#61KRhqZmhJddGRYRcI0Leb)" d="M30.251,44.483l-2.294-2.294l-1.414,1.414l2.294,2.294c0.39,0.39,0.901,0.585,1.413,0.585 s1.023-0.195,1.413-0.585l5.794-5.794l-1.414-1.414L30.251,44.483z"></path><linearGradient id="61KRhqZmhJddGRYRcI0Lec" x1="21" x2="21" y1="9.167" y2="54.188" gradientUnits="userSpaceOnUse" spreadMethod="reflect"><stop offset="0" stop-color="#1a6dff"></stop><stop offset="1" stop-color="#c822ff"></stop></linearGradient><path fill="url(#61KRhqZmhJddGRYRcI0Lec)" d="M17,22h2c0-3.309,2.691-6,6-6v-2C20.589,14,17,17.589,17,22z"></path><linearGradient id="61KRhqZmhJddGRYRcI0Led" x1="32" x2="32" y1="31.75" y2="54.705" gradientUnits="userSpaceOnUse" spreadMethod="reflect"><stop offset="0" stop-color="#6dc7ff"></stop><stop offset="1" stop-color="#e6abff"></stop></linearGradient><path fill="url(#61KRhqZmhJddGRYRcI0Led)" d="M32,54c-6.065,0-11-4.935-11-11s4.935-11,11-11s11,4.935,11,11S38.065,54,32,54z M32,34 c-4.963,0-9,4.037-9,9s4.037,9,9,9s9-4.037,9-9S36.963,34,32,34z"></path></svg>'},72:function(e,t,n){var i=n(73);"string"==typeof i&&(i=[[e.i,i,""]]);var o={insert:"head",singleton:!1};n(16)(i,o);i.locals&&(e.exports=i.locals)},73:function(e,t,n){(e.exports=n(15)(!1)).push([e.i,'.watermark-editor {\n  position: absolute;\n  left: 0;\n  top: 0;\n  right: 0;\n  bottom: 0;\n}\n.watermark-editor .surface-container {\n  position: absolute;\n  left: 0;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  overflow: hidden;\n}\n.watermark-editor .surface-container .surface {\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  display: inline-block;\n  overflow: hidden;\n  transition: top 100ms linear;\n}\n.watermark-editor .surface-container .surface svg {\n  width: 100%;\n  height: 100%;\n}\n.watermark-editor .surface-container .surface .image-preview {\n  transition: opacity 0.1s linear;\n  opacity: 0;\n}\n.watermark-editor .surface-container .surface .image-preview.visible {\n  opacity: 1;\n}\n.watermark-editor .surface-container .surface .selection {\n  fill-opacity: 0;\n  stroke: #1A6DFF;\n  stroke-width: 3px;\n  stroke-dasharray: 5, 5;\n  pointer-events: none;\n}\n.watermark-editor .surface-container .deselect-cover {\n  position: absolute;\n  left: 0;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.2);\n  border-top-right-radius: 4px;\n  border-bottom-right-radius: 4px;\n}\n.watermark-editor .item-options {\n  position: absolute;\n  right: 0;\n  top: 0;\n  bottom: 0;\n  background-color: #ffffff;\n  padding: 20px;\n  overflow: auto;\n  max-height: 100%;\n}\n.watermark-editor .item-options.floating {\n  right: auto;\n  bottom: auto;\n  border-radius: 4px;\n  box-shadow: 0 2px 10px 1px rgba(0, 0, 0, 0.2);\n}\n.watermark-editor .item-options.with-shadow {\n  border-radius: 4px;\n  box-shadow: 0 2px 10px 1px rgba(0, 0, 0, 0.2);\n}\n.watermark-editor .item-options.hidden {\n  opacity: 0;\n  pointer-events: none;\n}\n.watermark-editor .item-options.empty {\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n}\n.watermark-editor .item-options.empty .remove-button {\n  margin-top: 10px;\n}\n.watermark-editor .item-options.empty .hint {\n  font-size: 16px;\n}\n.watermark-editor .item-options.empty-has-no-watermark {\n  display: flex;\n  flex-direction: column;\n  justify-content: flex-start;\n  align-items: flex-start;\n  padding-bottom: 0;\n}\n.watermark-editor .item-options.empty-has-no-watermark .arrow {\n  font-family: "FontAwesome";\n  font-size: 30px;\n  transform: rotate(45deg);\n}\n.watermark-editor .item-options.empty-has-no-watermark .hint {\n  font-size: 16px;\n}\n.watermark-editor .item-options.empty-has-no-watermark .box {\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  justify-items: stretch;\n  align-items: center;\n  width: 100%;\n  padding: 0 10px 10px 10px;\n}\n.watermark-editor .item-options.empty-has-no-watermark .box .line {\n  box-sizing: border-box;\n  border-bottom: solid;\n  border-bottom-width: thin;\n  border-bottom-color: #7d8896;\n  width: 100px;\n  height: 0;\n}\n.watermark-editor .item-options.empty-has-no-watermark .box p {\n  padding: .5em;\n  font-size: 16px;\n}\n.watermark-editor .item-options > * {\n  position: relative;\n}\n.watermark-editor .item-options label {\n  display: block;\n  clear: both;\n  height: 26px;\n  margin-bottom: 10px;\n  padding-top: 3px;\n}\n.watermark-editor .item-options label > input,\n.watermark-editor .item-options label > .short-container,\n.watermark-editor .item-options label > .slider,\n.watermark-editor .item-options label > .font-picker,\n.watermark-editor .item-options label > .shadow-picker,\n.watermark-editor .item-options label > .filter-picker,\n.watermark-editor .item-options label > .Select,\n.watermark-editor .item-options label > textarea,\n.watermark-editor .item-options label > .button-group,\n.watermark-editor .item-options label > select,\n.watermark-editor .item-options label > .virtualized-select {\n  width: 250px;\n  margin: -7px 0 0 10px;\n  float: right;\n}\n.watermark-editor .item-options label > .Select {\n  margin-top: -6px;\n}\n.watermark-editor .item-options label > .slider:not(.mobile) {\n  margin-top: -3px;\n}\n.watermark-editor .item-options label > textarea {\n  height: 40px;\n  max-width: 250px;\n  min-width: 250px;\n  min-height: 40px;\n}\n.watermark-editor .item-options label > textarea,\n.watermark-editor .item-options label > .filter-picker,\n.watermark-editor .item-options label > button {\n  margin-bottom: 10px;\n}\n.watermark-editor .item-options label > .short-container {\n  display: inline-block;\n}\n.watermark-editor .item-options span label:only-child,\n.watermark-editor .item-options span label:last-child {\n  margin-bottom: 10px;\n}\n.watermark-editor .item-options .item-option-enter {\n  animation-duration: 300ms;\n}\n.watermark-editor .item-options .item-option-enter.item-option-enter-active {\n  animation-name: fadeInDown;\n}\n.watermark-editor .item-options .item-option-leave {\n  animation-duration: 300ms;\n}\n.watermark-editor .item-options .item-option-leave.item-option-leave-active {\n  animation-name: fadeOutUp;\n}\n.watermark-editor.mobile .item-options {\n  background-color: #F0F0F0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  top: 40%;\n  z-index: 2;\n  max-height: 60%;\n}\n.watermark-editor.mobile .item-options.only-scale-editor {\n  top: auto;\n}\n.watermark-editor.mobile .item-options.only-scale-editor label:last-child {\n  margin-bottom: 0;\n}\n.watermark-editor.mobile .item-options label,\n.watermark-editor.mobile .item-options span > label {\n  margin-bottom: 15px;\n}\n.watermark-editor.mobile .item-options label > textarea,\n.watermark-editor.mobile .item-options span > label > textarea,\n.watermark-editor.mobile .item-options label > .filter-picker,\n.watermark-editor.mobile .item-options span > label > .filter-picker {\n  margin-bottom: 15px;\n}\n.watermark-editor.mobile .surface-container {\n  border-top: 1px solid #d3d5d6;\n}\n.watermark-editor.mobile .surface-container .deselect-cover {\n  box-shadow: none;\n  border-top-right-radius: 0;\n  border-bottom-right-radius: 0;\n}\n.watermark-editor.mobile:not(.no-pan-to-view) .surface-container .surface {\n  top: 0;\n  transform: translateX(-50%);\n}\n@media (max-width: 420px) {\n  .watermark-editor.mobile .item-options label > input,\n  .watermark-editor.mobile .item-options label > .short-container,\n  .watermark-editor.mobile .item-options label > .slider,\n  .watermark-editor.mobile .item-options label > .font-picker,\n  .watermark-editor.mobile .item-options label > .shadow-picker,\n  .watermark-editor.mobile .item-options label > .filter-picker,\n  .watermark-editor.mobile .item-options label > .Select,\n  .watermark-editor.mobile .item-options label > textarea,\n  .watermark-editor.mobile .item-options label > .button-group,\n  .watermark-editor.mobile .item-options label > select,\n  .watermark-editor.mobile .item-options label > .virtualized-select {\n    width: 225px;\n    max-width: 225px;\n    min-width: 100px;\n  }\n}\n@media (max-width: 375px) {\n  .watermark-editor.mobile .item-options label {\n    height: 31px;\n  }\n  .watermark-editor.mobile .item-options label > input,\n  .watermark-editor.mobile .item-options label > .short-container,\n  .watermark-editor.mobile .item-options label > .slider,\n  .watermark-editor.mobile .item-options label > .font-picker,\n  .watermark-editor.mobile .item-options label > .shadow-picker,\n  .watermark-editor.mobile .item-options label > .filter-picker,\n  .watermark-editor.mobile .item-options label > .Select,\n  .watermark-editor.mobile .item-options label > textarea,\n  .watermark-editor.mobile .item-options label > .button-group,\n  .watermark-editor.mobile .item-options label > select,\n  .watermark-editor.mobile .item-options label > .virtualized-select {\n    width: 175px;\n    max-width: 175px;\n    min-width: 100px;\n  }\n}\n@media (max-width: 320px) {\n  .watermark-editor.mobile .item-options label > input,\n  .watermark-editor.mobile .item-options label > .short-container,\n  .watermark-editor.mobile .item-options label > .slider,\n  .watermark-editor.mobile .item-options label > .font-picker,\n  .watermark-editor.mobile .item-options label > .shadow-picker,\n  .watermark-editor.mobile .item-options label > .filter-picker,\n  .watermark-editor.mobile .item-options label > .Select,\n  .watermark-editor.mobile .item-options label > textarea,\n  .watermark-editor.mobile .item-options label > .button-group,\n  .watermark-editor.mobile .item-options label > select,\n  .watermark-editor.mobile .item-options label > .virtualized-select {\n    width: 150px;\n    max-width: 150px;\n    min-width: 100px;\n  }\n}\n.visualwatermark .watermark-editor .surface-container .surface .selection {\n  stroke: #ce5b32;\n}\n',""])},74:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="64px" height="64px" viewBox="0 0 64 64" version="1.1"><defs><linearGradient id="linear0" class="alt-svg-gradient" gradientUnits="userSpaceOnUse" x1="32" y1="11" x2="32" y2="53" spreadMethod="reflect" gradientTransform="matrix(-1,0,0,1,64,0)"><stop offset="0" style="stop-color:rgb(10.196078%,42.745098%,100%);stop-opacity:1;"></stop><stop offset="1" style="stop-color:rgb(78.431373%,13.333333%,100%);stop-opacity:1;"></stop></linearGradient><linearGradient id="linear1" class="main-svg-gradient" gradientUnits="userSpaceOnUse" x1="9" y1="16" x2="9" y2="48" spreadMethod="reflect"><stop offset="0" style="stop-color:rgb(42.745098%,78.039216%,100%);stop-opacity:1;"></stop><stop offset="1" style="stop-color:rgb(90.196078%,67.058824%,100%);stop-opacity:1;"></stop></linearGradient></defs><g id="surface12231"><path style=" stroke:none;fill-rule:nonzero;fill:url(#linear0);" d="M 57 11 L 57 13 L 7 13 L 7 11 Z M 57 31 L 7 31 L 7 33 L 57 33 Z M 43 21 L 7 21 L 7 23 L 43 23 Z M 43 41 L 7 41 L 7 43 L 43 43 Z M 57 51 L 7 51 L 7 53 L 57 53 Z M 57 51 "></path><path style=" stroke:none;fill-rule:nonzero;fill:url(#linear1);" d="M 11 16 L 11 18 L 7 18 L 7 16 Z M 11 26 L 11 28 L 7 28 L 7 26 Z M 11 36 L 11 38 L 7 38 L 7 36 Z M 11 46 L 11 48 L 7 48 L 7 46 Z M 11 46 "></path></g></svg>'},75:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="64px" height="64px" viewBox="0 0 64 64" version="1.1"><defs><linearGradient id="linear0" class="alt-svg-gradient" gradientUnits="userSpaceOnUse" x1="32" y1="11" x2="32" y2="53" spreadMethod="reflect"><stop offset="0" style="stop-color:rgb(10.196078%,42.745098%,100%);stop-opacity:1;"></stop><stop offset="1" style="stop-color:rgb(78.431373%,13.333333%,100%);stop-opacity:1;"></stop></linearGradient><linearGradient id="linear1" class="main-svg-gradient" gradientUnits="userSpaceOnUse" x1="32" y1="16" x2="32" y2="48" spreadMethod="reflect"><stop offset="0" style="stop-color:rgb(42.745098%,78.039216%,100%);stop-opacity:1;"></stop><stop offset="1" style="stop-color:rgb(90.196078%,67.058824%,100%);stop-opacity:1;"></stop></linearGradient></defs><g id="surface381296"><path style=" stroke:none;fill-rule:nonzero;fill:url(#linear0);" d="M 57 11 L 57 13 L 7 13 L 7 11 Z M 7 33 L 57 33 L 57 31 L 7 31 Z M 14 23 L 50 23 L 50 21 L 14 21 Z M 14 43 L 50 43 L 50 41 L 14 41 Z M 7 53 L 57 53 L 57 51 L 7 51 Z M 7 53 "></path><path style=" stroke:none;fill-rule:nonzero;fill:url(#linear1);" d="M 30 16 L 30 18 L 34 18 L 34 16 Z M 34 28 L 34 26 L 30 26 L 30 28 Z M 30 36 L 30 38 L 34 38 L 34 36 Z M 34 48 L 34 46 L 30 46 L 30 48 Z M 34 48 "></path></g></svg>'},76:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="64px" height="64px" viewBox="0 0 64 64" version="1.1"><defs><linearGradient id="linear0" class="alt-svg-gradient" gradientUnits="userSpaceOnUse" x1="32" y1="11" x2="32" y2="53" spreadMethod="reflect"><stop offset="0" style="stop-color:rgb(10.196078%,42.745098%,100%);stop-opacity:1;"></stop><stop offset="1" style="stop-color:rgb(78.431373%,13.333333%,100%);stop-opacity:1;"></stop></linearGradient><linearGradient id="linear1" class="main-svg-gradient" gradientUnits="userSpaceOnUse" x1="55" y1="16" x2="55" y2="48" spreadMethod="reflect"><stop offset="0" style="stop-color:rgb(42.745098%,78.039216%,100%);stop-opacity:1;"></stop><stop offset="1" style="stop-color:rgb(90.196078%,67.058824%,100%);stop-opacity:1;"></stop></linearGradient></defs><g id="surface10452"><path style=" stroke:none;fill-rule:nonzero;fill:url(#linear0);" d="M 57 11 L 57 13 L 7 13 L 7 11 Z M 7 33 L 57 33 L 57 31 L 7 31 Z M 21 23 L 57 23 L 57 21 L 21 21 Z M 21 43 L 57 43 L 57 41 L 21 41 Z M 7 53 L 57 53 L 57 51 L 7 51 Z M 7 53 "></path><path style=" stroke:none;fill-rule:nonzero;fill:url(#linear1);" d="M 57 16 L 57 18 L 53 18 L 53 16 Z M 57 26 L 57 28 L 53 28 L 53 26 Z M 57 36 L 57 38 L 53 38 L 53 36 Z M 57 46 L 57 48 L 53 48 L 53 46 Z M 57 46 "></path></g></svg>'}});